#include "./common.hlsli"

cbuffer cb0_buf : register(b0) {
  float4 cb0_m0 : packoffset(c0);
  float2 cb0_m1 : packoffset(c1);
  float2 cb0_m2 : packoffset(c1.z);
  float cb0_m3 : packoffset(c2);
  float3 cb0_m4 : packoffset(c2.y);
  float4 cb0_m5 : packoffset(c3);
  float4 cb0_m6 : packoffset(c4);
  float4 cb0_m7 : packoffset(c5);
  float2 cb0_m8 : packoffset(c6);
  uint2 cb0_m9 : packoffset(c6.z);
  float cb0_m10 : packoffset(c7);
  float3 cb0_m11 : packoffset(c7.y);
  float2 cb0_m12 : packoffset(c8);
  float2 cb0_m13 : packoffset(c8.z);
};

RWTexture3D<float4> u0 : register(u0);

static uint3 gl_GlobalInvocationID;
struct SPIRV_Cross_Input {
  uint3 gl_GlobalInvocationID : SV_DispatchThreadID;
};

float dp3_f32(float3 a, float3 b) {
  precise float _390 = a.x * b.x;
  return mad(a.z, b.z, mad(a.y, b.y, _390));
}

uint cvt_f32_u32(float v) {
  return (v > 4294967040.0f) ? 4294967295u : uint(max(v, 0.0f));
}

float dp2_f32(float2 a, float2 b) {
  precise float _370 = a.x * b.x;
  return mad(a.y, b.y, _370);
}

int cvt_f32_i32(float v) {
  return isnan(v) ? 0 : ((v < (-2147483648.0f)) ? int(0x80000000) : ((v > 2147483520.0f) ? 2147483647 : int(v)));
}

void comp_main() {
  float3 color_output;
  uint hdr_enabled_original = cb0_m9.x;
  uint hdr_enabled = hdr_enabled_original;

  float contrast = cb0_m8.y;
  float diffuse_white_scale = cb0_m1.y;  // diffuse white aka paper white, average brightness

#if 0
  hdr_enabled = false;
#endif

  float _413 = exp2(mad(float(gl_GlobalInvocationID.x), 0.2780952751636505126953125f, -9.72000026702880859375f));
  float _414 = exp2(mad(float(gl_GlobalInvocationID.y), 0.2780952751636505126953125f, -9.72000026702880859375f));
  float _415 = exp2(mad(float(gl_GlobalInvocationID.z), 0.2780952751636505126953125f, -9.72000026702880859375f));
  float _417 = max(_413, max(_415, _414));
  float _421 = (_417 - _413) / _417;
  float _422 = (_417 - _414) / _417;
  float _423 = (_417 - _415) / _417;
  float _427 = _421 - 0.814999997615814208984375f;
  float _428 = _422 - 0.802999973297119140625f;
  float _429 = _423 - 0.9900000095367431640625f;
  float3 _472 = float3(
      mad(-_417, (_421 < 0.814999997615814208984375f) ? _421 : (((_427 * 1.0f) / exp2(log2(exp2(log2(_427 * 3.055283069610595703125f) * 1.2000000476837158203125f) + 1.0f) * 0.833333313465118408203125f)) + 0.814999997615814208984375f), _417),
      mad(-_417, (_422 < 0.802999973297119140625f) ? _422 : (((_428 * 1.0f) / exp2(log2(exp2(log2(_428 * 3.49726104736328125f) * 1.2000000476837158203125f) + 1.0f) * 0.833333313465118408203125f)) + 0.802999973297119140625f), _417),
      mad(-_417, (_423 < 0.9900000095367431640625f) ? _423 : (((_429 * 0.999999940395355224609375f) / exp2(log2(exp2(log2(_429 * 98.70603179931640625f) * 1.2000000476837158203125f) + 1.0f) * 0.833333313465118408203125f)) + 0.9900000095367431640625f), _417));

#if 1
  float3 untonemapped_ap1 = _472;

  if (hdr_enabled == 1u && RENODX_TONE_MAP_TYPE != 0.f) {
    u0[gl_GlobalInvocationID] = GenerateLUTbuilderOutput(untonemapped_ap1);
    return;
  }

#endif

  // AP1 -> AP0
  float _473 = dp3_f32(float3(0.695452213287353515625f, 0.140678703784942626953125f, 0.16386906802654266357421875f), _472);
  float _474 = dp3_f32(float3(0.0447945632040500640869140625f, 0.859671115875244140625f, 0.095534317195415496826171875f), _472);
  float _475 = dp3_f32(float3(-0.0055258828215301036834716796875f, 0.0040252101607620716094970703125f, 1.00150072574615478515625f), _472);
  bool _480 = hdr_enabled != 0u;
  float _481 = _480 ? 200.0f : 125.0f;
  float _482 = _480 ? 1.0f : 0.89999997615814208984375f;
  float _483 = _480 ? 1.14999997615814208984375f : 1.03499996662139892578125f;
  float _484 = _480 ? 0.89999997615814208984375f : 1.0f;
  float _486 = max(_473, max(_474, _475));
  bool _487 = _486 <= 0.0f;
  float _491 = _487 ? 0.0f : (_473 / _486);
  float _492 = _487 ? 0.0f : (_474 / _486);
  float _493 = _487 ? 0.0f : (_475 / _486);
  float _497 = float(_493 <= _492);
  float _498 = mad(_492 - _493, _497, _493);
  float _499 = mad(_497, _493 - _492, _492);
  float _501 = mad(_497, -1.0f, 0.666666686534881591796875f);
  float _507 = float(_498 <= _491);
  float _509 = mad(_507, _499 - _499, _499);
  float _511 = mad(_507, _498 - _491, _491);
  float _518 = abs(((_511 - _509) / mad(mad(_491 - _498, _507, _498) - min(_511, _509), 6.0f, 1.0000000133514319600180897396058e-10f)) + mad(_507, mad(_497, 1.0f, -1.0f) - _501, _501));
  float _523 = clamp(mad(_518, 6.0f, -3.0f), 0.0f, 1.0f);
  float _524 = clamp(mad(_518, 6.0f, -4.0f), 0.0f, 1.0f);
  float _525 = _523 - _524;
  bool _528 = (cvt_f32_u32(mad(_518, 6.0f, 9.9999999747524270787835121154785e-07f)) & 1u) != 0u;
  float _532 = mad(frac(_518 * 6.0f), _528 ? 1.0f : (-1.0f), _528 ? 0.0f : 1.0f);
  bool _533 = _491 <= 0.0f;
  bool _534 = _492 <= 0.0f;
  bool _535 = _493 <= 0.0f;
  float _536 = log2(_491);
  float _537 = log2(_492);
  float _538 = log2(_493);
  float _546 = _532 + (_524 - _523);
  float _562 = 1.0f - _532;
  float _566 = _533 ? _491 : mad(_562, _491, (_525 * exp2(_536 * _483)) + (exp2(_536 * _482) * _546));
  float _567 = _534 ? _492 : mad(_562, _492, (_546 * exp2(_537 * _482)) + (_525 * exp2(_537 * _483)));
  float _568 = _535 ? _493 : mad(_562, _493, (_546 * exp2(_538 * _482)) + (_525 * exp2(_538 * _483)));
  float _575 = exp2(log2(_566) * _482);
  float _576 = exp2(log2(_567) * _482);
  float _577 = exp2(log2(_568) * _482);
  float _591 = _487 ? 0.0f : clamp(_486 / (mad(_486, _486, _486) + 0.004999999888241291046142578125f), 0.0f, 1.0f);
  float _592 = _591 * _591;
  float _599 = mad(_592, mad(_486, _533 ? _491 : mad(_532, _566 - _575, _575), -_473), _473);
  float _600 = mad(_592, mad(_486, _534 ? _492 : mad(_532, _567 - _576, _576), -_474), _474);
  float _601 = mad(_592, mad(_486, _535 ? _493 : mad(_532, _568 - _577, _577), -_475), _475);
  float _603 = max(_599, max(_600, _601));
  bool _604 = _603 <= 0.0f;
  float _608 = _604 ? 0.0f : (_599 / _603);
  float _609 = _604 ? 0.0f : (_600 / _603);
  float _610 = _604 ? 0.0f : (_601 / _603);
  float _614 = float(_609 >= _610);
  float _615 = mad(_609 - _610, _614, _610);
  float _616 = mad(_614, _610 - _609, _609);
  float _618 = mad(_614, -1.0f, 0.666666686534881591796875f);
  float _624 = float(_615 <= _608);
  float _626 = mad(_624, _616 - _616, _616);
  float _628 = mad(_624, _615 - _608, _608);
  float _635 = abs(((_628 - _626) / mad(mad(_608 - _615, _624, _615) - min(_628, _626), 6.0f, 1.0000000133514319600180897396058e-10f)) + mad(_624, mad(_614, 1.0f, -1.0f) - _618, _618));
  float _640 = clamp(mad(_635, 6.0f, -2.0f), 0.0f, 1.0f) - clamp(mad(_635, 6.0f, -3.0f), 0.0f, 1.0f);
  float _662 = _603 + 1.0f;
  float _667 = _604 ? 0.0f : clamp(1.0f - (1.0f / (_662 * _662)), 0.0f, 1.0f);
  float _674 = mad(mad(_603, (_608 <= 0.0f) ? _608 : mad(_640, exp2(log2(_608) * _484) - _608, _608), -_599), _667, _599);
  float _675 = mad(mad(_603, (_609 <= 0.0f) ? _609 : mad(_640, exp2(_484 * log2(_609)) - _609, _609), -_600), _667, _600);
  float _676 = mad(mad(_603, (_610 <= 0.0f) ? _610 : mad(_640, exp2(_484 * log2(_610)) - _610, _610), -_601), _667, _601);
  bool _677 = hdr_enabled == 1u;
  float _678 = max(_675, 0.0f);
  float _679 = max(_676, 0.0f);
  float _680 = max(_674, 0.0f);
  float _684 = float(_678 >= _679);
  float _685 = mad(_678 - _679, _684, _679);
  float _686 = mad(_684, _679 - _678, _678);
  float _688 = mad(_684, -1.0f, 0.666666686534881591796875f);
  float _694 = float(_685 <= _680);
  float _696 = mad(_694, _686 - _686, _686);
  float _698 = mad(_685 - _680, _694, _680);
  float _705 = abs(mad(mad(_684, 1.0f, -1.0f) - _688, _694, _688) + ((_698 - _696) / mad(mad(_680 - _685, _694, _685) - min(_698, _696), 6.0f, 1.0000000133514319600180897396058e-10f)));
  float _706 = mad(_705, -540.0f, 92.59999847412109375f);
  float _707 = mad(_705, -360.0f, 123.44000244140625f);
  float _716 = clamp(-((92.59999847412109375f - _706) * (1.0f / _706)), 0.0f, 1.0f);
  float _720 = (mad(_716, -2.0f, 3.0f) * (_716 * _716)) * 1.25f;
  float _723 = clamp((1.0f / ((-30.840000152587890625f) - _707)) * (92.59999847412109375f - _707), 0.0f, 1.0f);
  float _727 = mad(_705, 360.0f, -30.5f);
  float _738 = clamp((1.0f / mad(_705, -360.0f, 325.0f)) * mad(_705, -360.0f, 375.0f), 0.0f, 1.0f);
  float _739 = mad(_738, -2.0f, 3.0f);
  float _740 = _738 * _738;
  float _756 = (_677 || ((max(_674, max(_676, _675)) - min(_674, min(_676, _675))) < 0.001000000047497451305389404296875f)) ? 0.0f : min(clamp(_720 + (clamp(_727 + _727, 0.0f, 1.0f) * (((mad(_723, -2.0f, 3.0f) * (_723 * _723)) * 1.25f) - _720)), 0.0f, 1.0f) + ((_705 < 0.977777779102325439453125f) ? (_739 * _740) : mad(_739, _740, clamp(mad(_705, 360.0f, -352.0f) * 0.0199999995529651641845703125f, 0.0f, 1.0f))), 1.0f);
  float _763 = mad(cb0_m12.x - cb0_m0.x, _756, cb0_m0.x);
  float _771 = mad(exp2(cb0_m13.y * 3.3219280242919921875f) - cb0_m7.w, _756, cb0_m7.w);
  float3 _780 = float3(dp2_f32(float2(0.952552378177642822265625f, 9.3678601842839270830154418945313e-05f), float2(_674, _676)) * _481, dp3_f32(float3(0.3439664542675018310546875f, 0.728166103363037109375f, -0.07213254272937774658203125f), float3(_674, _675, _676)) * _481, (_676 * _481) * 1.00882518291473388671875f);
  float3 _787 = float3(dp3_f32(float3(0.732800006866455078125f, 0.4296000003814697265625f, -0.1624000072479248046875f), _780) * 0.9848167896270751953125f, dp3_f32(float3(-0.703599989414215087890625f, 1.6974999904632568359375f, 0.006099999882280826568603515625f), _780) * 1.001965045928955078125f, dp3_f32(float3(0.0030000000260770320892333984375f, 0.013600000180304050445556640625f, 0.98339998722076416015625f), _780) * 1.07822644710540771484375f);
  float _788 = dp3_f32(float3(1.09612381458282470703125f, -0.2788690030574798583984375f, 0.18274517357349395751953125f), _787);
  float _790 = dp3_f32(float3(-0.0096276104450225830078125f, -0.005698029883205890655517578125f, 1.01532566547393798828125f), _787);
  float3 _797 = float3((_788 * 1.14999997615814208984375f) + (_790 * (-0.1500000059604644775390625f)), (dp3_f32(float3(0.4543690383434295654296875f, 0.473533153533935546875f, 0.072097800672054290771484375f), _787) * 0.699999988079071044921875f) + (_788 * 0.300000011920928955078125f), _790);
  float _798 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _797);
  float _799 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _797);
  float _800 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _797);
  float _813 = exp2(log2(abs(_798) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _814 = exp2(log2(abs(_799) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _815 = exp2(log2(abs(_800) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _862 = (_799 == 0.0f) ? 0.0f : (exp2(log2(mad(_814, 18.8515625f, 0.8359375f) / mad(_814, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_799 > 0.0f) + ((_799 < 0.0f) ? 4294967295u : 0u))));
  float3 _864 = float3((_798 == 0.0f) ? 0.0f : (float(int(((_798 < 0.0f) ? 4294967295u : 0u) + uint(_798 > 0.0f))) * exp2(log2(mad(_813, 18.8515625f, 0.8359375f) / mad(_813, 18.6875f, 1.0f)) * 134.0343780517578125f)), _862, (_800 == 0.0f) ? 0.0f : (exp2(log2(mad(_815, 18.8515625f, 0.8359375f) / mad(_815, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_800 > 0.0f) + ((_800 < 0.0f) ? 4294967295u : 0u)))));
  float _865 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _864);
  float _866 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _864);
  float _867 = max(_862, 0.0f);
  float _874 = _480 ? 0.89826238155364990234375f : 0.84369838237762451171875f;
  float _881 = exp2(log2(dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), float3((_480 ? 218.6048583984375f : 136.6280364990234375f) + (_480 ? (-32.671733856201171875f) : (-20.419834136962890625f)), (_480 ? 140.0f : 87.5f) + (_480 ? 57.027355194091796875f : 35.64209747314453125f), _480 ? 217.811553955078125f : 136.132232666015625f)) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _885 = log2(mad(_881, 18.8515625f, 0.8359375f) / mad(_881, 18.6875f, 1.0f));
  float _890 = min(exp2(log2(_867) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _905 = (((_867 <= 0.0f) || (_890 <= 0.8359375f)) ? 0.0f : ((float(int(_867 > 0.0f)) * exp2(log2((_890 - 0.8359375f) / mad(_890, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10285.52734375f)) / _481;
  float _907 = log2(max(_905, 6.103515625e-05f));
  float _908 = _907 * 0.3010300099849700927734375f;
  float _1144;
  if (_763 >= _908) {
    _1144 = mad(_908, cb0_m0.z, mad(-_763, cb0_m0.z, cb0_m0.y));
  } else {
    float _925 = mad(cb0_m12.y - cb0_m0.w, _756, cb0_m0.w);
    float _1143;
    if (_908 < _925) {
      float _934 = (mad(_907, 0.3010300099849700927734375f, -_763) * 3.0f) / (_925 - _763);
      int _935 = cvt_f32_i32(_934);
      float _937 = _934 - trunc(_934);
      uint _938 = uint(_935);
      float _964 = mad(float(_938 == 5u), cb0_m5.z, mad(float(_938 == 4u), cb0_m5.y, mad(float(_938 == 3u), cb0_m5.x, dp3_f32(float3(float(_938 == 0u), float(_938 == 1u), float(_938 == 2u)), cb0_m4))));
      uint _966 = uint(_935 + 1);
      uint _968 = uint(_935 + 2);
      float _987 = mad(float(_966 == 5u), cb0_m5.z, mad(float(_966 == 4u), cb0_m5.y, mad(float(_966 == 3u), cb0_m5.x, dp3_f32(float3(float(_966 == 0u), float(_966 == 1u), float(_966 == 2u)), cb0_m4))));
      float2 _1006 = float2(_964, _987);
      _1143 = dp3_f32(float3(_937 * _937, _937, 1.0f), float3(dp3_f32(float3(_964, mad(float(_968 == 5u), cb0_m5.z, mad(float(_968 == 4u), cb0_m5.y, mad(float(_968 == 3u), cb0_m5.x, dp3_f32(float3(float(_968 == 0u), float(_968 == 1u), float(_968 == 2u)), cb0_m4)))), _987), float3(0.5f, 0.5f, -1.0f)), dp2_f32(_1006, float2(-1.0f, 1.0f)), dp2_f32(_1006, 0.5f.xx)));
    } else {
      float _1017 = mad(cb0_m10 - cb0_m5.w, _756, cb0_m5.w);
      float _1034 = mad(cb0_m11.x - cb0_m6.x, _756, cb0_m6.x);
      float _1035 = mad(_756, cb0_m11.y - cb0_m6.y, cb0_m6.y);
      float _1036 = mad(_756, cb0_m11.z - cb0_m6.z, cb0_m6.z);
      float _1037 = mad(_756, cb0_m11.z - cb0_m6.w, cb0_m6.w);
      float _1043 = mad(cb0_m11.z - cb0_m7.x, _756, cb0_m7.x);
      float _1055 = mad(cb0_m13.x - cb0_m2.x, _756, cb0_m2.x);
      float _1062 = (mad(_907, 0.3010300099849700927734375f, -_925) * 3.0f) / (_1055 - _925);
      int _1063 = cvt_f32_i32(_1062);
      float _1065 = _1062 - trunc(_1062);
      uint _1066 = uint(_1063);
      float _1085 = mad(_1043, float(_1066 == 5u), mad(float(_1066 == 4u), _1037, mad(float(_1066 == 3u), _1036, mad(float(_1066 == 2u), _1035, (_1034 * float(_1066 == 1u)) + (_1017 * float(_1066 == 0u))))));
      uint _1087 = uint(_1063 + 1);
      uint _1089 = uint(_1063 + 2);
      float _1110 = mad(_1043, float(_1087 == 5u), mad(float(_1087 == 4u), _1037, mad(float(_1087 == 3u), _1036, mad(float(_1087 == 2u), _1035, (_1034 * float(_1087 == 1u)) + (_1017 * float(_1087 == 0u))))));
      float2 _1131 = float2(_1085, _1110);
      _1143 = (_908 < _1055) ? dp3_f32(float3(_1065 * _1065, _1065, 1.0f), float3(dp3_f32(float3(_1085, mad(_1043, float(_1089 == 5u), mad(float(_1089 == 4u), _1037, mad(float(_1089 == 3u), _1036, mad(float(_1089 == 2u), _1035, (_1034 * float(_1089 == 1u)) + (_1017 * float(_1089 == 0u)))))), _1110), float3(0.5f, 0.5f, -1.0f)), dp2_f32(_1131, float2(-1.0f, 1.0f)), dp2_f32(_1131, 0.5f.xx))) : mad(_908, cb0_m3, mad(-cb0_m3, _1055, mad(_756, cb0_m13.y - cb0_m2.y, cb0_m2.y)));
    }
    _1144 = _1143;
  }
  float _1146 = exp2(_1144 * 3.3219280242919921875f);
  float _1151 = exp2(log2(_1146 * 9.7223979537375271320343017578125e-05f) * 0.1593017578125f);
  float _1164 = ((_1146 <= 0.0f) || (_1146 == 0.0f)) ? 0.0f : (float(int(_1146 > 0.0f)) * exp2(log2(mad(_1151, 18.8515625f, 0.8359375f) / mad(_1151, 18.6875f, 1.0f)) * 134.0343780517578125f));
  float _1168 = abs(_865);
  float _1169 = abs(_866);
  float _1173 = min(_1168, _1169) * (1.0f / max(_1168, _1169));
  float _1174 = _1173 * _1173;
  float _1178 = mad(_1174, mad(_1174, mad(_1174, mad(_1174, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
  float _1187 = mad(_1173, _1178, (_1168 < _1169) ? mad(_1173 * _1178, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_865 < (-_865)) ? (-3.1415927410125732421875f) : 0.0f);
  float _1188 = min(_865, _866);
  float _1189 = max(_865, _866);
  float _1198 = mad(((_1188 < (-_1188)) && (_1189 >= (-_1189))) ? (-_1187) : _1187, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
  float _1201 = frac(_1198);
  float _1205 = ((_865 == 0.0f) && (_866 == 0.0f)) ? 0.0f : (((_1198 >= (-_1198)) ? _1201 : (-_1201)) * 360.0f);
  float _1217 = float(int(((_1164 < 0.0f) ? 4294967295u : 0u) + uint(_1164 > 0.0f)));
  float _1219 = log2(abs(_1164));
  float _1231 = exp2(_885 * 104.54681396484375f);
  float _1232 = exp2(_885 * 145.2740936279296875f);
  float _1233 = ((_1164 == 0.0f) ? 0.0f : ((_1217 * exp2(_1219 * 0.96444904804229736328125f)) * 100.0f)) / exp2(_885 * 129.2693328857421875f);
  float2 _1234 = float2(_865, _866);
  float _1243 = exp2(log2(cos((_1205 + 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f) * _874;
  float _1244 = _1231 * 0.89125096797943115234375f;
  float _1246 = (_1243 / _1244) * (exp2(log2(dp2_f32(_1234, _1234)) * 0.37000000476837158203125f) * 100.0f);
  float _1329;
  if (_905 >= 0.180000007152557373046875f) {
    float _1251 = _480 ? 4.0f : 3.5f;
    float _1266 = exp2(log2(abs(cb0_m7.z * 0.97223985195159912109375f) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _1292 = (log2(max((_867 + (((cb0_m7.z <= 0.0f) || (cb0_m7.z == 0.0f)) ? 0.0f : (float(int(((cb0_m7.z < 0.0f) ? 4294967295u : 0u) + uint(cb0_m7.z > 0.0f))) * exp2(log2(mad(_1266, 18.8515625f, 0.8359375f) / mad(_1266, 18.6875f, 1.0f)) * 134.0343780517578125f)))) - exp2(log2((_480 ? 8.49391937255859375f : 7.941486835479736328125f) / (_480 ? 8.591335296630859375f : 8.0437107086181640625f)) * 134.0343780517578125f), 5.9604644775390625e-08f)) * 0.3010300099849700927734375f) - (log2(max(_1164, 5.9604644775390625e-08f)) * 0.3010300099849700927734375f);
    float _1293 = _1292 * _1251;
    float _1294 = _677 ? 0.699999988079071044921875f : 0.75f;
    float _1296 = _677 ? 65503.30078125f : 65503.25f;
    float _1308 = mad(_1292, _1251, _677 ? (-0.699999988079071044921875f) : (-0.75f));
    float _1320 = clamp((_1293 < _1294) ? _1293 : ((_1308 / exp2(log2(exp2(log2(_1308 / (_1296 / exp2(log2(exp2(log2((_677 ? 0.300000011920928955078125f : 0.25f) / _1296) * (-1.2000000476837158203125f)) - 1.0f) * 0.833333313465118408203125f))) * 1.2000000476837158203125f) + 1.0f) * 0.833333313465118408203125f)) + _1294), 0.0f, 1.0f);
    _1329 = 1.0f - ((_1320 > 0.800000011920928955078125f) ? mad(1.0f - (1.0f / mad(_1320 - 0.800000011920928955078125f, 5.0f, 1.0f)), 0.20000000298023223876953125f, 0.800000011920928955078125f) : _1320);
  } else {
    _1329 = 1.0f;
  }
  float _1331 = min(exp2(_1219 * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _1349 = clamp(((((_1164 <= 0.0f) || (_1331 <= 0.8359375f)) ? 0.0f : ((_1217 * exp2(log2((_1331 - 0.8359375f) / mad(_1331, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10285.52734375f)) - cb0_m7.z) / cb0_m7.z, 0.0f, 1.0f) * (_867 - _1164);
  float _1360 = mad((1.0f - ((_1349 > 0.2909090816974639892578125f) ? mad(1.0f - (1.0f / mad(mad(_1349, 2.75f, -0.800000011920928955078125f), 5.0f, 1.0f)), 0.20000000298023223876953125f, 0.800000011920928955078125f) : (_1349 * 2.75f))) - _1329, _756, _1329);
  float _1361 = _1246 * _1360;
  float _1362 = _480 ? 0.486570894718170166015625f : 0.4123909175395965576171875f;
  float _1363 = _480 ? 0.2656676471233367919921875f : 0.35758435726165771484375f;
  float _1364 = _480 ? 0.19821725785732269287109375f : 0.18048079311847686767578125f;
  float _1365 = _480 ? 0.22897456586360931396484375f : 0.21263907849788665771484375f;
  float _1366 = _480 ? 0.691738426685333251953125f : 0.7151687145233154296875f;
  float _1367 = _480 ? 0.0792869031429290771484375f : 0.07219231128692626953125f;
  float _1368 = _480 ? 0.0f : 0.0193308256566524505615234375f;
  float _1369 = _480 ? 0.045113377273082733154296875f : 0.119194783270359039306640625f;
  float _1370 = _480 ? 1.04394423961639404296875f : 0.950532138347625732421875f;
  float3 _1371 = float3(_1362, _1363, _1364);
  float3 _1372 = _771.xxx;
  float _1373 = dp3_f32(_1371, _1372);
  float3 _1374 = float3(_1365, _1366, _1367);
  float3 _1376 = float3(_1368, _1369, _1370);
  float _1377 = dp3_f32(_1376, _1372);
  float _1385 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), float3((_1373 * 1.14999997615814208984375f) + (_1377 * (-0.1500000059604644775390625f)), (dp3_f32(_1374, _1372) * 0.699999988079071044921875f) + (_1373 * 0.300000011920928955078125f), _1377));
  float _1390 = exp2(log2(abs(_1385) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _1407 = (_1385 == 0.0f) ? 0.0f : max(float(int(((_1385 < 0.0f) ? 4294967295u : 0u) + uint(_1385 > 0.0f))) * exp2(log2(mad(_1390, 18.8515625f, 0.8359375f) / mad(_1390, 18.6875f, 1.0f)) * 134.0343780517578125f), 0.0f);
  float _1427 = _1205 * 0.0174532942473888397216796875f;
  float _1429 = _1233 * _1232;
  float _1432 = _1243 * 100.0f;
  float _1433 = ((_1361 * _1231) * 0.89125096797943115234375f) / _1432;
  float _1447 = (_1433 == 0.0f) ? 0.0f : (float(int(((_1433 < 0.0f) ? 4294967295u : 0u) + uint(_1433 > 0.0f))) * exp2(log2(abs(_1433)) * 1.35135138034820556640625f));
  float _1461 = (_1429 == 0.0f) ? 0.0f : (float(int(((_1429 < 0.0f) ? 4294967295u : 0u) + uint(_1429 > 0.0f))) * exp2(log2(abs(_1429 * 0.00999999977648258209228515625f)) * 0.922630965709686279296875f));
  float _1462 = sin(_1427);
  float _1463 = cos(_1427);
  float3 _1466 = float3(_1461, _1463 * _1447, _1462 * _1447);
  float _1467 = dp3_f32(float3(1.0f, 0.277210056781768798828125f, 0.116094626486301422119140625f), _1466);
  float _1468 = dp3_f32(float3(1.0f, 0.0425858013331890106201171875f, -0.753844559192657470703125f), _1466);
  float _1481 = min(exp2(log2(abs(_1467)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _1482 = min(exp2(log2(abs(_1461)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _1483 = min(exp2(log2(abs(_1468)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _1533 = (_1482 <= 0.8359375f) ? 0.0f : ((exp2(log2((_1482 - 0.8359375f) / mad(_1482, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_1461 > 0.0f) + ((_1461 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f);
  float3 _1535 = float3((_1481 <= 0.8359375f) ? 0.0f : ((float(int(((_1467 < 0.0f) ? 4294967295u : 0u) + uint(_1467 > 0.0f))) * exp2(log2((_1481 - 0.8359375f) / mad(_1481, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10000.0f), _1533, (_1483 <= 0.8359375f) ? 0.0f : ((exp2(log2((_1483 - 0.8359375f) / mad(_1483, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_1468 > 0.0f) + ((_1468 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f));
  float _1538 = dp3_f32(float3(-0.089891873300075531005859375f, -0.3052776157855987548828125f, 1.51366293430328369140625f), _1535);
  float _1539 = mad(_1538, 0.1500000059604644775390625f, dp3_f32(float3(1.9734058380126953125f, -0.996146976947784423828125f, -0.02567376196384429931640625f), _1535));

  // if hdr_enabled ? XYZ -> DCI-P3 : XYZ -> BT.709

  // _1543 = hdr_enabled ? float3(2.49349689, -0.93138361, -0.402710766) : float3(3.24096918, -1.53738272, -0.498610646);
  // _1546 = hdr_enabled ? float3(-0.829488993, 1.76266408, 0.0236246902) : float3(-0.969243646, 1.87596738, 0.0415550806);
  // _1548 = hdr_enabled ? float3(0.035845831, -0.0761723891, 0.956884503) : float3(0.0556300804, -0.203976959, 1.05697155);

  float3 _1543 = float3(_480 ? 2.49349689483642578125f : 3.240969181060791015625f,
                        _480 ? (-0.931383609771728515625f) : (-1.53738272190093994140625f),
                        _480 ? (-0.4027107656002044677734375f) : (-0.4986106455326080322265625f));
  float3 _1544 = float3(_1539 * 0.8695652484893798828125f,
                        mad(_1539, -0.2608695924282073974609375f, dp3_f32(float3(0.350645840167999267578125f, 0.708214223384857177734375f, -0.046372711658477783203125f), _1535)) * 1.4285714626312255859375f,
                        _1538);
  float3 _1546 = float3(_480 ? (-0.8294889926910400390625f) : (-0.96924364566802978515625f),
                        _480 ? 1.7626640796661376953125f : 1.87596738338470458984375f,
                        _480 ? 0.02362469024956226348876953125f : 0.0415550805628299713134765625f);
  float3 _1548 = float3(_480 ? 0.03584583103656768798828125f : 0.055630080401897430419921875f,
                        _480 ? (-0.076172389090061187744140625f) : (-0.2039769589900970458984375f),
                        _480 ? 0.95688450336456298828125f : 1.05697154998779296875f);
  float _1550 = dp3_f32(_1543, _1544) / _481;
  float _1551 = dp3_f32(_1546, _1544) / _481;
  float _1552 = dp3_f32(_1548, _1544) / _481;
  bool _1557 = ((_1550 < 0.0f) || (_1551 < 0.0f)) || (_1552 < 0.0f);
  float _1559 = min(min(_1550, _1551), _1552);
  float _1563 = _1557 ? (_1550 - _1559) : _1550;
  float _1564 = _1557 ? (_1551 - _1559) : _1551;
  float _1565 = _1557 ? (_1552 - _1559) : _1552;
  bool _1570 = (_1565 > 1.0f) || ((_1563 > 1.0f) || (_1564 > 1.0f));
  float _1572 = max(max(_1563, _1564), _1565);
  float _1576 = _1570 ? (_1564 / _1572) : _1564;
  float _1577 = _1570 ? (_1565 / _1572) : _1565;
  float _1578 = _1570 ? (_1563 / _1572) : _1563;
  float _1582 = float(_1576 >= _1577);
  float _1583 = mad(_1576 - _1577, _1582, _1577);
  float _1584 = mad(_1582, _1577 - _1576, _1576);
  float _1586 = mad(_1582, -1.0f, 0.666666686534881591796875f);
  float _1592 = float(_1583 <= _1578);
  float _1594 = mad(_1592, _1584 - _1584, _1584);
  float _1596 = mad(_1592, _1583 - _1578, _1578);
  float _1603 = abs(((_1596 - _1594) / mad(mad(_1578 - _1583, _1592, _1583) - min(_1596, _1594), 6.0f, 1.0000000133514319600180897396058e-10f)) + mad(_1592, mad(_1582, 1.0f, -1.0f) - _1586, _1586));
  float3 _1625 = float3(_771 * clamp(abs(mad(frac(_1603 + 1.0f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f), _771 * clamp(abs(mad(frac(_1603 + 0.666666686534881591796875f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f), _771 * clamp(abs(mad(frac(_1603 + 0.3333333432674407958984375f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f));
  float _1626 = dp3_f32(_1371, _1625);
  float _1628 = dp3_f32(_1376, _1625);
  float3 _1635 = float3((_1626 * 1.14999997615814208984375f) + (_1628 * (-0.1500000059604644775390625f)), (dp3_f32(_1374, _1625) * 0.699999988079071044921875f) + (_1626 * 0.300000011920928955078125f), _1628);
  float _1636 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _1635);
  float _1637 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _1635);
  float _1638 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _1635);
  float _1651 = exp2(log2(abs(_1636) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _1652 = exp2(log2(abs(_1637) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _1653 = exp2(log2(abs(_1638) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _1700 = (_1637 == 0.0f) ? 0.0f : (exp2(log2(mad(_1652, 18.8515625f, 0.8359375f) / mad(_1652, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_1637 > 0.0f) + ((_1637 < 0.0f) ? 4294967295u : 0u))));
  float3 _1702 = float3((_1636 == 0.0f) ? 0.0f : (float(int(((_1636 < 0.0f) ? 4294967295u : 0u) + uint(_1636 > 0.0f))) * exp2(log2(mad(_1651, 18.8515625f, 0.8359375f) / mad(_1651, 18.6875f, 1.0f)) * 134.0343780517578125f)), _1700, (_1638 == 0.0f) ? 0.0f : (exp2(log2(mad(_1653, 18.8515625f, 0.8359375f) / mad(_1653, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_1638 > 0.0f) + ((_1638 < 0.0f) ? 4294967295u : 0u)))));
  float _1703 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _1702);
  float _1704 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _1702);
  float _1705 = max(_1700, 0.0f);
  float _1709 = abs(_1703);
  float _1710 = abs(_1704);
  float _1714 = min(_1709, _1710) * (1.0f / max(_1709, _1710));
  float _1715 = _1714 * _1714;
  float _1719 = mad(_1715, mad(_1715, mad(_1715, mad(_1715, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
  float _1728 = mad(_1714, _1719, (_1709 < _1710) ? mad(_1714 * _1719, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_1703 < (-_1703)) ? (-3.1415927410125732421875f) : 0.0f);
  float _1729 = min(_1703, _1704);
  float _1730 = max(_1703, _1704);
  float _1739 = mad(((_1729 < (-_1729)) && (_1730 >= (-_1730))) ? (-_1728) : _1728, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
  float _1742 = frac(_1739);
  float _1746 = ((_1703 == 0.0f) && (_1704 == 0.0f)) ? 0.0f : (((_1739 >= (-_1739)) ? _1742 : (-_1742)) * 360.0f);
  float _1761 = ((_1705 == 0.0f) ? 0.0f : ((float(int(_1705 > 0.0f)) * exp2(log2(_1705) * 1.08385694026947021484375f)) * 100.0f)) / _1232;
  float2 _1762 = float2(_1703, _1704);
  float _1773 = (exp2(log2(dp2_f32(_1762, _1762)) * 0.37000000476837158203125f) * 100.0f) * ((exp2(log2(cos((_1746 + 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f) * _874) / _1244);
  float _1996;
  float _1997;
  if (_1205 != _1746) {
    bool _1777 = _1205 > _1746;
    float _1778 = _1777 ? 1.0f : (-1.0f);
    float _1779 = _1777 ? 0.00277777784503996372222900390625f : (-0.00277777784503996372222900390625f);
    float _1781;
    float _1784;
    _1781 = _1773;
    _1784 = _1761;
    float _1782;
    float _1785;
    float _1787;
    float _1789;
    uint _1791;
    float _1991;
    float _1992;
    bool _1993;
    float _1786 = _1746;
    float _1788 = _1603;
    uint _1790 = 0u;
    for (;;) {
      if (int(_1790) >= 360) {
        _1991 = 0.0f;
        _1992 = 0.0f;
        _1993 = true;
        break;
      }
      _1789 = _1779 + _1788;
      float3 _1819 = float3(_771 * clamp(abs(mad(frac(_1789 + 1.0f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f), _771 * clamp(abs(mad(frac(_1789 + 0.666666686534881591796875f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f), _771 * clamp(abs(mad(frac(_1789 + 0.3333333432674407958984375f), 6.0f, -3.0f)) - 1.0f, 0.0f, 1.0f));
      float _1820 = dp3_f32(_1371, _1819);
      float _1822 = dp3_f32(_1376, _1819);
      float3 _1829 = float3((_1820 * 1.14999997615814208984375f) + (_1822 * (-0.1500000059604644775390625f)), (dp3_f32(_1374, _1819) * 0.699999988079071044921875f) + (_1820 * 0.300000011920928955078125f), _1822);
      float _1830 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _1829);
      float _1831 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _1829);
      float _1832 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _1829);
      float _1845 = exp2(log2(abs(_1830) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
      float _1846 = exp2(log2(abs(_1831) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
      float _1847 = exp2(log2(abs(_1832) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
      float _1894 = (_1831 == 0.0f) ? 0.0f : (exp2(log2(mad(_1846, 18.8515625f, 0.8359375f) / mad(_1846, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_1831 > 0.0f) + ((_1831 < 0.0f) ? 4294967295u : 0u))));
      float3 _1896 = float3((_1830 == 0.0f) ? 0.0f : (float(int(((_1830 < 0.0f) ? 4294967295u : 0u) + uint(_1830 > 0.0f))) * exp2(log2(mad(_1845, 18.8515625f, 0.8359375f) / mad(_1845, 18.6875f, 1.0f)) * 134.0343780517578125f)), _1894, (_1832 == 0.0f) ? 0.0f : (exp2(log2(mad(_1847, 18.8515625f, 0.8359375f) / mad(_1847, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_1832 > 0.0f) + ((_1832 < 0.0f) ? 4294967295u : 0u)))));
      float _1897 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _1896);
      float _1898 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _1896);
      float _1899 = max(_1894, 0.0f);
      float _1903 = abs(_1897);
      float _1904 = abs(_1898);
      float _1908 = min(_1903, _1904) * (1.0f / max(_1903, _1904));
      float _1909 = _1908 * _1908;
      float _1913 = mad(_1909, mad(_1909, mad(_1909, mad(_1909, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
      float _1922 = mad(_1908, _1913, (_1903 < _1904) ? mad(_1908 * _1913, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_1897 < (-_1897)) ? (-3.1415927410125732421875f) : 0.0f);
      float _1923 = min(_1897, _1898);
      float _1924 = max(_1897, _1898);
      float _1933 = mad(((_1923 < (-_1923)) && (_1924 >= (-_1924))) ? (-_1922) : _1922, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
      float _1936 = frac(_1933);
      _1787 = ((_1897 == 0.0f) && (_1898 == 0.0f)) ? 0.0f : (((_1933 >= (-_1933)) ? _1936 : (-_1936)) * 360.0f);
      _1785 = ((_1899 == 0.0f) ? 0.0f : ((float(int(_1899 > 0.0f)) * exp2(log2(_1899) * 1.08385694026947021484375f)) * 100.0f)) / _1232;
      float2 _1954 = float2(_1897, _1898);
      _1782 = (exp2(log2(dp2_f32(_1954, _1954)) * 0.37000000476837158203125f) * 100.0f) * ((exp2(log2(cos((_1787 + 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f) * _874) / _1244);
      if (((_1778 != ((_1205 == _1787) ? 0.0f : ((_1205 > _1787) ? 1.0f : (-1.0f)))) || (_1789 < 0.0f)) || (_1789 > 1.0f)) {
        bool _1976 = _1786 <= _1787;
        float _1978 = _1976 ? _1784 : _1785;
        float _1980 = _1976 ? _1781 : _1782;
        float _1982 = _1976 ? _1786 : _1787;
        float _1988 = clamp((_1205 - _1982) / ((_1976 ? _1787 : _1786) - _1982), 0.0f, 1.0f);
        _1991 = mad(_1988, (_1976 ? _1782 : _1781) - _1980, _1980);
        _1992 = mad(_1988, (_1976 ? _1785 : _1784) - _1978, _1978);
        _1993 = false;
        break;
      }
      _1791 = _1790 + 1u;
      _1781 = _1782;
      _1784 = _1785;
      _1786 = _1787;
      _1788 = _1789;
      _1790 = _1791;
      continue;
    }
    _1996 = _1993 ? _1781 : _1991;
    _1997 = _1993 ? _1784 : _1992;
  } else {
    _1996 = _1773;
    _1997 = _1761;
  }
  float _2002 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), float3(cb0_m7.z * 0.92966556549072265625f, cb0_m7.z * 0.9851367473602294921875f, cb0_m7.z * 1.08905780315399169921875f));
  float _2007 = exp2(log2(abs(_2002) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
  float _2024 = (_2002 == 0.0f) ? 0.0f : max(float(int(((_2002 < 0.0f) ? 4294967295u : 0u) + uint(_2002 > 0.0f))) * exp2(log2(mad(_2007, 18.8515625f, 0.8359375f) / mad(_2007, 18.6875f, 1.0f)) * 134.0343780517578125f), 0.0f);
  float _2035 = ((_1407 == 0.0f) ? 0.0f : ((float(int(_1407 > 0.0f)) * exp2(log2(_1407) * 1.08385694026947021484375f)) * 100.0f)) / _1232;
  float _2038 = mad((((_2024 == 0.0f) ? 0.0f : ((float(int(_2024 > 0.0f)) * exp2(log2(_2024) * 1.08385694026947021484375f)) * 100.0f)) / _1232) - _1997, 0.5f, _1997);
  float _2048 = _1996 * ((_1233 > _2038) ? ((_2035 - _2038) / max(_2035 - min(_1233, _2035), 9.9999997473787516355514526367188e-05f)) : (_2038 / max(_1233, 9.9999997473787516355514526367188e-05f)));
  float _2049 = _2048 * (-0.5f);
  float _2052 = (_1233 - _2038) / (_1361 - _2049);
  float _2054 = mad(-_2049, _2052, _2038);
  float _3124;
  float _3125;
  if (((_2038 == _2054) && (_2049 == 0.0f)) || ((_2054 <= 0.0f) || (_2035 <= _2054))) {
    _3124 = 0.0f;
    _3125 = _2054;
  } else {
    float _2066 = _771 * _1362;
    float _2067 = _771 * _1363;
    float _2068 = _771 * _1364;
    float _2072 = _771 * _1368;
    float _2073 = _771 * _1369;
    float _2074 = _771 * _1370;
    float3 _2089 = float3((_2066 * 1.14999997615814208984375f) - (_2072 * 0.1500000059604644775390625f), ((_771 * _1365) * 0.699999988079071044921875f) + (_2066 * 0.300000011920928955078125f), _2072);
    float _2090 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _2089);
    float _2091 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _2089);
    float _2092 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _2089);
    float _2105 = exp2(log2(abs(_2090) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2106 = exp2(log2(abs(_2091) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2107 = exp2(log2(abs(_2092) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2156 = float3((_2090 == 0.0f) ? 0.0f : (float(int(((_2090 < 0.0f) ? 4294967295u : 0u) + uint(_2090 > 0.0f))) * exp2(log2(mad(_2105, 18.8515625f, 0.8359375f) / mad(_2105, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2091 == 0.0f) ? 0.0f : (exp2(log2(mad(_2106, 18.8515625f, 0.8359375f) / mad(_2106, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2091 > 0.0f) + ((_2091 < 0.0f) ? 4294967295u : 0u)))), (_2092 == 0.0f) ? 0.0f : (exp2(log2(mad(_2107, 18.8515625f, 0.8359375f) / mad(_2107, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2092 > 0.0f) + ((_2092 < 0.0f) ? 4294967295u : 0u)))));
    float _2157 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2156);
    float _2158 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2156);
    float _2162 = abs(_2157);
    float _2163 = abs(_2158);
    float _2167 = min(_2162, _2163) * (1.0f / max(_2162, _2163));
    float _2168 = _2167 * _2167;
    float _2172 = mad(_2168, mad(_2168, mad(_2168, mad(_2168, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2181 = mad(_2167, _2172, (_2162 < _2163) ? mad(_2167 * _2172, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2157 < (-_2157)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2182 = min(_2157, _2158);
    float _2183 = max(_2157, _2158);
    float _2192 = mad(((_2182 < (-_2182)) && (_2183 >= (-_2183))) ? (-_2181) : _2181, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2195 = frac(_2192);
    float2 _2202 = float2(_2157, _2158);
    float2 _2216 = _771.xx;
    float _2217 = dp2_f32(float2(_1362, _1363), _2216);
    float _2221 = dp2_f32(float2(_1368, _1369), _2216);
    float3 _2228 = float3((_2217 * 1.14999997615814208984375f) + (_2221 * (-0.1500000059604644775390625f)), (dp2_f32(float2(_1365, _1366), _2216) * 0.699999988079071044921875f) + (_2217 * 0.300000011920928955078125f), _2221);
    float _2229 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _2228);
    float _2230 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _2228);
    float _2231 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _2228);
    float _2244 = exp2(log2(abs(_2229) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2245 = exp2(log2(abs(_2230) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2246 = exp2(log2(abs(_2231) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2295 = float3((_2229 == 0.0f) ? 0.0f : (float(int(((_2229 < 0.0f) ? 4294967295u : 0u) + uint(_2229 > 0.0f))) * exp2(log2(mad(_2244, 18.8515625f, 0.8359375f) / mad(_2244, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2230 == 0.0f) ? 0.0f : (exp2(log2(mad(_2245, 18.8515625f, 0.8359375f) / mad(_2245, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2230 > 0.0f) + ((_2230 < 0.0f) ? 4294967295u : 0u)))), (_2231 == 0.0f) ? 0.0f : (exp2(log2(mad(_2246, 18.8515625f, 0.8359375f) / mad(_2246, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2231 > 0.0f) + ((_2231 < 0.0f) ? 4294967295u : 0u)))));
    float _2296 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2295);
    float _2297 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2295);
    float _2301 = abs(_2296);
    float _2302 = abs(_2297);
    float _2306 = min(_2301, _2302) * (1.0f / max(_2301, _2302));
    float _2307 = _2306 * _2306;
    float _2311 = mad(_2307, mad(_2307, mad(_2307, mad(_2307, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2320 = mad(_2306, _2311, (_2301 < _2302) ? mad(_2306 * _2311, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2296 < (-_2296)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2321 = min(_2296, _2297);
    float _2322 = max(_2296, _2297);
    float _2331 = mad(((_2321 < (-_2321)) && (_2322 >= (-_2322))) ? (-_2320) : _2320, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2334 = frac(_2331);
    float2 _2341 = float2(_2296, _2297);
    float3 _2355 = float3((_2067 * 0.300000011920928955078125f) + ((_771 * _1366) * 0.699999988079071044921875f), (_2067 * 1.14999997615814208984375f) - (_2073 * 0.1500000059604644775390625f), _2073);
    float _2356 = dp3_f32(float3(0.579999029636383056640625f, 0.404802799224853515625f, 0.0246349014341831207275390625f), _2355);
    float _2357 = dp3_f32(float3(1.1421759128570556640625f, -0.20150999724864959716796875f, 0.0315739214420318603515625f), _2355);
    float _2358 = dp3_f32(float3(0.264800012111663818359375f, -0.01660080067813396453857421875f, 0.66847991943359375f), _2355);
    float _2371 = exp2(log2(abs(_2356) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2372 = exp2(log2(abs(_2357) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2373 = exp2(log2(abs(_2358) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2422 = float3((_2356 == 0.0f) ? 0.0f : (float(int(((_2356 < 0.0f) ? 4294967295u : 0u) + uint(_2356 > 0.0f))) * exp2(log2(mad(_2371, 18.8515625f, 0.8359375f) / mad(_2371, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2357 == 0.0f) ? 0.0f : (exp2(log2(mad(_2372, 18.8515625f, 0.8359375f) / mad(_2372, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2357 > 0.0f) + ((_2357 < 0.0f) ? 4294967295u : 0u)))), (_2358 == 0.0f) ? 0.0f : (exp2(log2(mad(_2373, 18.8515625f, 0.8359375f) / mad(_2373, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2358 > 0.0f) + ((_2358 < 0.0f) ? 4294967295u : 0u)))));
    float _2423 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2422);
    float _2424 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2422);
    float _2428 = abs(_2423);
    float _2429 = abs(_2424);
    float _2433 = min(_2428, _2429) * (1.0f / max(_2428, _2429));
    float _2434 = _2433 * _2433;
    float _2438 = mad(_2434, mad(_2434, mad(_2434, mad(_2434, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2447 = mad(_2433, _2438, (_2428 < _2429) ? mad(_2433 * _2438, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2423 < (-_2423)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2448 = min(_2423, _2424);
    float _2449 = max(_2423, _2424);
    float _2458 = mad(((_2448 < (-_2448)) && (_2449 >= (-_2449))) ? (-_2447) : _2447, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2461 = frac(_2458);
    float2 _2468 = float2(_2423, _2424);
    float _2483 = dp2_f32(float2(_1363, _1364), _2216);
    float _2487 = dp2_f32(float2(_1369, _1370), _2216);
    float3 _2494 = float3((_2483 * 1.14999997615814208984375f) + (_2487 * (-0.1500000059604644775390625f)), (dp2_f32(float2(_1366, _1367), _2216) * 0.699999988079071044921875f) + (_2483 * 0.300000011920928955078125f), _2487);
    float _2495 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _2494);
    float _2496 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _2494);
    float _2497 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _2494);
    float _2510 = exp2(log2(abs(_2495) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2511 = exp2(log2(abs(_2496) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2512 = exp2(log2(abs(_2497) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2561 = float3((_2495 == 0.0f) ? 0.0f : (float(int(((_2495 < 0.0f) ? 4294967295u : 0u) + uint(_2495 > 0.0f))) * exp2(log2(mad(_2510, 18.8515625f, 0.8359375f) / mad(_2510, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2496 == 0.0f) ? 0.0f : (exp2(log2(mad(_2511, 18.8515625f, 0.8359375f) / mad(_2511, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2496 > 0.0f) + ((_2496 < 0.0f) ? 4294967295u : 0u)))), (_2497 == 0.0f) ? 0.0f : (exp2(log2(mad(_2512, 18.8515625f, 0.8359375f) / mad(_2512, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2497 > 0.0f) + ((_2497 < 0.0f) ? 4294967295u : 0u)))));
    float _2562 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2561);
    float _2563 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2561);
    float _2567 = abs(_2562);
    float _2568 = abs(_2563);
    float _2572 = min(_2567, _2568) * (1.0f / max(_2567, _2568));
    float _2573 = _2572 * _2572;
    float _2577 = mad(_2573, mad(_2573, mad(_2573, mad(_2573, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2586 = mad(_2572, _2577, (_2567 < _2568) ? mad(_2572 * _2577, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2562 < (-_2562)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2587 = min(_2562, _2563);
    float _2588 = max(_2562, _2563);
    float _2597 = mad(((_2587 < (-_2587)) && (_2588 >= (-_2588))) ? (-_2586) : _2586, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2600 = frac(_2597);
    float2 _2607 = float2(_2562, _2563);
    float _2620 = max(max(max((exp2(log2(dp2_f32(_2202, _2202)) * 0.37000000476837158203125f) * 100.0f) * ((_874 * (((_2157 == 0.0f) && (_2158 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2192 >= (-_2192)) ? _2195 : (-_2195), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244), (exp2(log2(dp2_f32(_2341, _2341)) * 0.37000000476837158203125f) * 100.0f) * ((_874 * (((_2296 == 0.0f) && (_2297 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2331 >= (-_2331)) ? _2334 : (-_2334), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244)), (exp2(log2(dp2_f32(_2468, _2468)) * 0.37000000476837158203125f) * 100.0f) * ((_874 * (((_2423 == 0.0f) && (_2424 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2458 >= (-_2458)) ? _2461 : (-_2461), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244)), ((_874 * (((_2562 == 0.0f) && (_2563 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2597 >= (-_2597)) ? _2600 : (-_2600), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244) * (exp2(log2(dp2_f32(_2607, _2607)) * 0.37000000476837158203125f) * 100.0f));
    float3 _2625 = float3((_2068 * 1.14999997615814208984375f) - (_2074 * 0.1500000059604644775390625f), (_2068 * 0.300000011920928955078125f) + ((_771 * _1367) * 0.699999988079071044921875f), _2074);
    float _2626 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _2625);
    float _2627 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _2625);
    float _2628 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _2625);
    float _2641 = exp2(log2(abs(_2626) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2642 = exp2(log2(abs(_2627) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2643 = exp2(log2(abs(_2628) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2692 = float3((_2626 == 0.0f) ? 0.0f : (float(int(((_2626 < 0.0f) ? 4294967295u : 0u) + uint(_2626 > 0.0f))) * exp2(log2(mad(_2641, 18.8515625f, 0.8359375f) / mad(_2641, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2627 == 0.0f) ? 0.0f : (exp2(log2(mad(_2642, 18.8515625f, 0.8359375f) / mad(_2642, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2627 > 0.0f) + ((_2627 < 0.0f) ? 4294967295u : 0u)))), (_2628 == 0.0f) ? 0.0f : (exp2(log2(mad(_2643, 18.8515625f, 0.8359375f) / mad(_2643, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2628 > 0.0f) + ((_2628 < 0.0f) ? 4294967295u : 0u)))));
    float _2693 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2692);
    float _2694 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2692);
    float _2698 = abs(_2693);
    float _2699 = abs(_2694);
    float _2703 = min(_2698, _2699) * (1.0f / max(_2698, _2699));
    float _2704 = _2703 * _2703;
    float _2708 = mad(_2704, mad(_2704, mad(_2704, mad(_2704, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2717 = mad(_2703, _2708, (_2698 < _2699) ? mad(_2703 * _2708, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2693 < (-_2693)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2718 = min(_2693, _2694);
    float _2719 = max(_2693, _2694);
    float _2728 = mad(((_2718 < (-_2718)) && (_2719 >= (-_2719))) ? (-_2717) : _2717, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2731 = frac(_2728);
    float2 _2738 = float2(_2693, _2694);
    float _2753 = dp2_f32(float2(_1362, _1364), _2216);
    float _2757 = dp2_f32(float2(_1368, _1370), _2216);
    float3 _2764 = float3((_2753 * 1.14999997615814208984375f) + (_2757 * (-0.1500000059604644775390625f)), (dp2_f32(float2(_1365, _1367), _2216) * 0.699999988079071044921875f) + (_2753 * 0.300000011920928955078125f), _2757);
    float _2765 = dp3_f32(float3(0.404802799224853515625f, 0.579999029636383056640625f, 0.0246349014341831207275390625f), _2764);
    float _2766 = dp3_f32(float3(-0.20150999724864959716796875f, 1.1421759128570556640625f, 0.0315739214420318603515625f), _2764);
    float _2767 = dp3_f32(float3(-0.01660080067813396453857421875f, 0.264800012111663818359375f, 0.66847991943359375f), _2764);
    float _2780 = exp2(log2(abs(_2765) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2781 = exp2(log2(abs(_2766) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float _2782 = exp2(log2(abs(_2767) * 9.9999997473787516355514526367188e-05f) * 0.1593017578125f);
    float3 _2831 = float3((_2765 == 0.0f) ? 0.0f : (float(int(((_2765 < 0.0f) ? 4294967295u : 0u) + uint(_2765 > 0.0f))) * exp2(log2(mad(_2780, 18.8515625f, 0.8359375f) / mad(_2780, 18.6875f, 1.0f)) * 134.0343780517578125f)), (_2766 == 0.0f) ? 0.0f : (exp2(log2(mad(_2781, 18.8515625f, 0.8359375f) / mad(_2781, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2766 > 0.0f) + ((_2766 < 0.0f) ? 4294967295u : 0u)))), (_2767 == 0.0f) ? 0.0f : (exp2(log2(mad(_2782, 18.8515625f, 0.8359375f) / mad(_2782, 18.6875f, 1.0f)) * 134.0343780517578125f) * float(int(uint(_2767 > 0.0f) + ((_2767 < 0.0f) ? 4294967295u : 0u)))));
    float _2832 = dp3_f32(float3(3.5239999294281005859375f, -4.066708087921142578125f, 0.542707979679107666015625f), _2831);
    float _2833 = dp3_f32(float3(0.199075996875762939453125f, 1.09679901599884033203125f, -1.29587495326995849609375f), _2831);
    float _2837 = abs(_2832);
    float _2838 = abs(_2833);
    float _2842 = min(_2837, _2838) * (1.0f / max(_2837, _2838));
    float _2843 = _2842 * _2842;
    float _2847 = mad(_2843, mad(_2843, mad(_2843, mad(_2843, 0.02083509974181652069091796875f, -0.08513300120830535888671875f), 0.1801410019397735595703125f), -0.33029949665069580078125f), 0.999866008758544921875f);
    float _2856 = mad(_2842, _2847, (_2837 < _2838) ? mad(_2842 * _2847, -2.0f, 1.57079637050628662109375f) : 0.0f) + ((_2832 < (-_2832)) ? (-3.1415927410125732421875f) : 0.0f);
    float _2857 = min(_2832, _2833);
    float _2858 = max(_2832, _2833);
    float _2867 = mad(((_2857 < (-_2857)) && (_2858 >= (-_2858))) ? (-_2856) : _2856, 57.2957763671875f, 360.0f) * 0.00277777784503996372222900390625f;
    float _2870 = frac(_2867);
    float2 _2877 = float2(_2832, _2833);
    float _2890 = max(max(_2620, ((_874 * (((_2693 == 0.0f) && (_2694 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2728 >= (-_2728)) ? _2731 : (-_2731), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244) * (exp2(log2(dp2_f32(_2738, _2738)) * 0.37000000476837158203125f) * 100.0f)), (exp2(log2(dp2_f32(_2877, _2877)) * 0.37000000476837158203125f) * 100.0f) * ((_874 * (((_2832 == 0.0f) && (_2833 == 0.0f)) ? 1.0021302700042724609375f : exp2(log2(cos(mad((_2867 >= (-_2867)) ? _2870 : (-_2870), 360.0f, 89.03800201416015625f) * 0.0174532942473888397216796875f) + 1.01499998569488525390625f) * 0.06800000369548797607421875f))) / _1244));
    uint _2906 = asuint((_1996 * 0.3333333432674407958984375f) + (mad(_1996, -0.3333333432674407958984375f, 0.100000001490116119384765625f) * ((_1233 > _1997) ? clamp((_1233 - _1997) / max(_2035 - _1997, 9.9999999747524270787835121154785e-07f), 0.0f, 1.0f) : clamp((_1997 - _1233) / max(_1997, 9.9999999747524270787835121154785e-07f), 0.0f, 1.0f))));
    float _2907 = _771 / _481;
    float _2908 = _2054 - _2038;
    float _2910 = mad(-_2048, -0.5f, 0.0f);
    float2 _2911 = float2(_2908, _2910);
    float _2913 = rsqrt(dp2_f32(_2911, _2911));
    float _2914 = _2908 * _2913;
    float _2915 = _2910 * _2913;
    uint _2922;
    uint _2924;
    _2922 = 0u;
    _2924 = asuint(_2054);
    uint _2927;
    uint _2918;
    uint _2921;
    uint _2923;
    uint _2925;
    uint _2917 = 4294967295u;
    uint _2920 = _2906;
    uint _2926 = 0u;
    for (;;) {
      if (int(_2926) >= 10) {
        break;
      }
      uint _2936;
      uint _2939;
      uint _2941;
      uint _2935 = _2922;
      uint _2938 = _2924;
      uint _2940 = 0u;
      for (;;) {
        if (int(_2940) >= 128) {
          _2918 = _2917;
          _2921 = _2920;
          _2923 = _2935;
          _2925 = _2938;
          break;
        }
        float _2948 = asfloat(_2920);
        float _2951 = mad(_2914, _2948, asfloat(_2938));
        float _2952 = mad(_2915, _2948, asfloat(_2935));
        _2939 = asuint(_2951);
        _2936 = asuint(_2952);
        float _2954 = _2951 * _1232;
        float _2957 = ((_2952 * _1231) * 0.89125096797943115234375f) / _1432;
        float _2971 = (_2957 == 0.0f) ? 0.0f : (float(int(((_2957 < 0.0f) ? 4294967295u : 0u) + uint(_2957 > 0.0f))) * exp2(log2(abs(_2957)) * 1.35135138034820556640625f));
        float _2985 = (_2954 == 0.0f) ? 0.0f : (float(int(((_2954 < 0.0f) ? 4294967295u : 0u) + uint(_2954 > 0.0f))) * exp2(log2(abs(_2954 * 0.00999999977648258209228515625f)) * 0.922630965709686279296875f));
        float3 _2988 = float3(_2985, _1463 * _2971, _1462 * _2971);
        float _2989 = dp3_f32(float3(1.0f, 0.277210056781768798828125f, 0.116094626486301422119140625f), _2988);
        float _2990 = dp3_f32(float3(1.0f, 0.0425858013331890106201171875f, -0.753844559192657470703125f), _2988);
        float _3003 = min(exp2(log2(abs(_2989)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
        float _3004 = min(exp2(log2(abs(_2985)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
        float _3005 = min(exp2(log2(abs(_2990)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
        float3 _3057 = float3((_3003 <= 0.8359375f) ? 0.0f : ((float(int(((_2989 < 0.0f) ? 4294967295u : 0u) + uint(_2989 > 0.0f))) * exp2(log2((_3003 - 0.8359375f) / mad(_3003, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10000.0f), (_3004 <= 0.8359375f) ? 0.0f : ((exp2(log2((_3004 - 0.8359375f) / mad(_3004, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_2985 > 0.0f) + ((_2985 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f), (_3005 <= 0.8359375f) ? 0.0f : ((exp2(log2((_3005 - 0.8359375f) / mad(_3005, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_2990 > 0.0f) + ((_2990 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f));
        float _3060 = dp3_f32(float3(-0.089891873300075531005859375f, -0.3052776157855987548828125f, 1.51366293430328369140625f), _3057);

        // maybe related to JzAzBz?
        float _3061 = mad(_3060, 0.1500000059604644775390625f,
                          dp3_f32(float3(1.9734058380126953125f, -0.996146976947784423828125f, -0.02567376196384429931640625f),
                                  _3057));
        float3 _3068 = float3((_3061 * 0.8695652484893798828125f) / _481, (mad(_3061, -0.2608695924282073974609375f, dp3_f32(float3(0.350645840167999267578125f, 0.708214223384857177734375f, -0.046372711658477783203125f), _3057)) * 1.4285714626312255859375f) / _481, _3060 / _481);
        float _3072 = dp3_f32(_1543, _3068) / _2907;
        float _3073 = dp3_f32(_1546, _3068) / _2907;
        float _3074 = dp3_f32(_1548, _3068) / _2907;
        float _3082 = clamp((max(_3072, max(_3074, _3073)) * 0.100000001490116119384765625f) * (1.0f - min(_3072, min(_3074, _3073))), 0.0f, 0.100000001490116119384765625f);
        float _3083 = 1.0f - _3082;
        float3 _3090 = float3(_3072 - clamp(_3072, _3082, _3083), _3073 - clamp(_3073, _3082, _3083), _3074 - clamp(_3074, _3082, _3083));
        bool _3093 = dp3_f32(_3090, _3090) <= (_3082 * _3082);
        if (((((_2951 < 0.0f) || (_2035 < _2951)) || (_2952 > _2890)) || (!_3093)) && (_2917 != 0u)) {
          _2918 = 0u;
          _2921 = asuint(abs(_2948) * (-0.5f));
          _2923 = _2936;
          _2925 = _2939;
          break;
        } else {
          if ((_3093 || (_2952 < 0.0f)) && ((~_2917) != 0u)) {
            _2918 = 4294967295u;
            _2921 = asuint(abs(_2948) * 0.5f);
            _2923 = _2936;
            _2925 = _2939;
            break;
          }
        }
        _2941 = _2940 + 1u;
        _2935 = _2936;
        _2938 = _2939;
        _2940 = _2941;
        continue;
      }
      _2927 = _2926 + 1u;
      _2917 = _2918;
      _2920 = _2921;
      _2922 = _2923;
      _2924 = _2925;
      _2926 = _2927;
      continue;
    }
    _3124 = min(max(asfloat(_2922), 0.0f), _2890);
    _3125 = clamp(asfloat(_2924), 0.0f, _2035);
  }
  float _3127 = mad(_2049, _2052, -_2038);
  float2 _3130 = float2(_3127 + _3125, _3124 - 0.0f);
  float _3134 = 1.0f / max(sqrt(dp2_f32(_3130, _3130)), 9.9999997473787516355514526367188e-05f);
  float _3135 = _1233 + _3127;
  float _3136 = mad(_1246, _1360, -0.0f);
  float2 _3137 = float2(_3135, _3136);
  float _3138 = dp2_f32(_3137, _3137);
  float _3139 = sqrt(_3138);
  float _3140 = _3134 * _3139;
  float _3141 = _677 ? 0.699999988079071044921875f : 0.75f;
  float _3143 = _677 ? 0.500000059604644775390625f : 0.4500000476837158203125f;
  float _3155 = mad(_3134, _3139, _677 ? (-0.699999988079071044921875f) : (-0.75f));
  float _3166 = (_3140 < _3141) ? _3140 : ((_3155 / exp2(log2(exp2(log2(_3155 / (_3143 / exp2(log2(exp2(log2((_677 ? 0.300000011920928955078125f : 0.25f) / _3143) * (-1.2000000476837158203125f)) - 1.0f) * 0.833333313465118408203125f))) * 1.2000000476837158203125f) + 1.0f) * 0.833333313465118408203125f)) + _3141);
  bool _3169 = (_1361 == 0.0f) && (_1233 == _2054);
  float _3170 = rsqrt(_3138);
  float _3179 = _3169 ? _2054 : (_2054 + (((_3135 * _3170) * _3166) / _3134));
  float _3180 = _3169 ? 0.0f : ((((_3136 * _3170) * _3166) / _3134) + 0.0f);
  bool _3181 = hdr_enabled == 0u;
  float _3309;
  float _3310;
  if (_3181) {
    uint _3186;
    float _3281;
    uint _3185 = 0u;
    for (;;) {
      int _3190 = int(_3185);
      if (_3190 >= 128) {
        _3281 = -1.0f;
        break;
      }
      float _3195 = float(_3190) + 1.0f;
      float _3198 = ((_3195 * _1231) * 0.89125096797943115234375f) / _1432;
      float _3212 = (_3198 == 0.0f) ? 0.0f : (float(int(((_3198 < 0.0f) ? 4294967295u : 0u) + uint(_3198 > 0.0f))) * exp2(log2(abs(_3198)) * 1.35135138034820556640625f));
      float3 _3215 = float3(_1461, _1463 * _3212, _1462 * _3212);
      float _3216 = dp3_f32(float3(1.0f, 0.277210056781768798828125f, 0.116094626486301422119140625f), _3215);
      float _3217 = dp3_f32(float3(1.0f, 0.0425858013331890106201171875f, -0.753844559192657470703125f), _3215);
      float _3226 = min(exp2(log2(abs(_3216)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
      float _3227 = min(exp2(log2(abs(_3217)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
      float3 _3262 = float3((_3226 <= 0.8359375f) ? 0.0f : ((float(int(((_3216 < 0.0f) ? 4294967295u : 0u) + uint(_3216 > 0.0f))) * exp2(log2((_3226 - 0.8359375f) / mad(_3226, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10000.0f), _1533, (_3227 <= 0.8359375f) ? 0.0f : ((exp2(log2((_3227 - 0.8359375f) / mad(_3227, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_3217 > 0.0f) + ((_3217 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f));
      float _3265 = dp3_f32(float3(-0.089891873300075531005859375f, -0.3052776157855987548828125f, 1.51366293430328369140625f), _3262);
      float _3266 = mad(_3265, 0.1500000059604644775390625f,
                        dp3_f32(float3(1.9734058380126953125f, -0.996146976947784423828125f, -0.02567376196384429931640625f),
                                _3262));
      float3 _3270 = float3(_3266 * 0.8695652484893798828125f, mad(_3266, -0.2608695924282073974609375f, dp3_f32(float3(0.350645840167999267578125f, 0.708214223384857177734375f, -0.046372711658477783203125f), _3262)) * 1.4285714626312255859375f, _3265);
      if ((dp3_f32(float3(0.055630080401897430419921875f, -0.2039769589900970458984375f, 1.05697154998779296875f), _3270) < 0.0f) || ((dp3_f32(float3(-0.96924364566802978515625f, 1.87596738338470458984375f, 0.0415550805628299713134765625f), _3270) < 0.0f) || (dp3_f32(float3(3.240969181060791015625f, -1.53738272190093994140625f, -0.4986106455326080322265625f), _3270) < 0.0f))) {
        _3281 = _3195;
        break;
      }
      _3186 = _3185 + 1u;
      _3185 = _3186;
      continue;
    }
    float _3282 = max(_3281, 0.0f);
    float _3286 = (_3282 > 2.0f) ? _3282 : mad(_3282 * _3282, 0.25f, 1.0f);
    float _3288 = _1361 / _3286;
    float _3290 = _3288 - 0.680000007152557373046875f;
    _3309 = mad(((_1361 >= 9.9999999747524270787835121154785e-07f) ? max(_3286 * ((_3288 < 0.680000007152557373046875f) ? _3288 : ((_3290 / exp2(log2(exp2(log2(_3290 * 1.786310672760009765625f) * 1.0750000476837158203125f) + 1.0f) * 0.930232524871826171875f)) + 0.680000007152557373046875f)), 9.9999999747524270787835121154785e-07f) : _1361) - _3180, _756, _3180);
    _3310 = mad(_756, _1233 - _3179, _3179);
  } else {
    _3309 = _3180;
    _3310 = _3179;
  }
  float _3313 = (_1233 != 0.0f) ? (_3310 / _1233) : 1.0f;
  float _3316 = ((_1231 * _3309) * 0.89125096797943115234375f) / _1432;
  float _3330 = (_3316 == 0.0f) ? 0.0f : (float(int(((_3316 < 0.0f) ? 4294967295u : 0u) + uint(_3316 > 0.0f))) * exp2(log2(abs(_3316)) * 1.35135138034820556640625f));
  float3 _3333 = float3(_1461, _1463 * _3330, _1462 * _3330);
  float _3334 = dp3_f32(float3(1.0f, 0.277210056781768798828125f, 0.116094626486301422119140625f), _3333);
  float _3335 = dp3_f32(float3(1.0f, 0.0425858013331890106201171875f, -0.753844559192657470703125f), _3333);
  float _3344 = min(exp2(log2(abs(_3334)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float _3345 = min(exp2(log2(abs(_3335)) * 0.0074607725255191326141357421875f), 1.00870001316070556640625f);
  float3 _3380 = float3((_3344 <= 0.8359375f) ? 0.0f : ((float(int(((_3334 < 0.0f) ? 4294967295u : 0u) + uint(_3334 > 0.0f))) * exp2(log2((_3344 - 0.8359375f) / mad(_3344, -18.6875f, 18.8515625f)) * 6.277394771575927734375f)) * 10000.0f), _1533, (_3345 <= 0.8359375f) ? 0.0f : ((exp2(log2((_3345 - 0.8359375f) / mad(_3345, -18.6875f, 18.8515625f)) * 6.277394771575927734375f) * float(int(uint(_3335 > 0.0f) + ((_3335 < 0.0f) ? 4294967295u : 0u)))) * 10000.0f));
  float _3383 = dp3_f32(float3(-0.089891873300075531005859375f, -0.3052776157855987548828125f, 1.51366293430328369140625f), _3380);
  float _3384 = mad(_3383, 0.1500000059604644775390625f,
                    dp3_f32(float3(1.9734058380126953125f, -0.996146976947784423828125f, -0.02567376196384429931640625f),
                            _3380));
  float3 _3401 = float3((_3384 * _3313) * 0.8695652484893798828125f, (mad(_3384, -0.2608695924282073974609375f, dp3_f32(float3(0.350645840167999267578125f, 0.708214223384857177734375f, -0.046372711658477783203125f), _3380)) * _3313) * 1.4285714626312255859375f, _3383 * _3313);
  float _3407 = dp3_f32(float3(_480 ? 1.71665096282958984375f : 3.240969181060791015625f, _480 ? (-0.355670750141143798828125f) : (-1.53738272190093994140625f), _480 ? (-0.2533662319183349609375f) : (-0.4986106455326080322265625f)), _3401);
  float _3408 = dp3_f32(float3(_480 ? (-0.66668426990509033203125f) : (-0.96924364566802978515625f), _480 ? 1.6164810657501220703125f : 1.87596738338470458984375f, _480 ? 0.01576853729784488677978515625f : 0.0415550805628299713134765625f), _3401);
  float _3409 = dp3_f32(float3(_480 ? 0.0176398567855358123779296875f : 0.055630080401897430419921875f, _480 ? (-0.0427706129848957061767578125f) : (-0.2039769589900970458984375f), _480 ? 0.942103087902069091796875f : 1.05697154998779296875f), _3401);

  //   _3407 = max(0, _3407);
  //   _3408 = max(0, _3408);
  //   _3409 = max(0, _3409);

  float _3536;
  float _3537;
  float _3538;
  if (_3181) {
    color_output = float3(_3407, _3408, _3409) / 100.f;

    color_output = renodx::color::srgb::EncodeSafe(color_output);
    // color_output = renodx::color::correct::GammaSafe(color_output);

  } else {
    float _3437 = _3407 / _481;
    float _3438 = _3408 / _481;
    float _3439 = _3409 / _481;
    float _3454 = (_3437 <= 0.0f) ? 0.0f : exp2(log2(_3437) * contrast);
    float _3455 = (_3438 <= 0.0f) ? 0.0f : exp2(log2(_3438) * contrast);
    float _3456 = (_3439 <= 0.0f) ? 0.0f : exp2(log2(_3439) * contrast);
    bool _3457 = contrast >= 1.0f;
    float _3458 = 2.0f - _3437;
    float _3459 = 2.0f - _3438;
    float _3460 = 2.0f - _3439;
    float _3467 = clamp(_3458 * (_3458 * _3458), 0.0f, 1.0f);
    float _3468 = clamp((_3459 * _3459) * _3459, 0.0f, 1.0f);
    float _3469 = clamp((_3460 * _3460) * _3460, 0.0f, 1.0f);
    float _3493 = _771 * 1.2000000476837158203125f;
    float _3494 = clamp(cb0_m1.y * (_481 * (_3457 ? _3454 : ((_3467 * _3454) + (_3437 * (1.0f - _3467))))), 0.0f, _3493);
    float _3495 = clamp((_481 * (_3457 ? _3455 : (((1.0f - _3468) * _3438) + (_3468 * _3455)))) * cb0_m1.y, 0.0f, _3493);
    float _3496 = clamp((_481 * (_3457 ? _3456 : (((1.0f - _3469) * _3439) + (_3469 * _3456)))) * cb0_m1.y, 0.0f, _3493);
    float _3515 = (_3494 == 0.0f) ? 0.0f : exp2(log2(abs(_3494 * 9.9999997473787516355514526367188e-05f)) * 0.1593017578125f);
    float _3516 = (_3495 == 0.0f) ? 0.0f : exp2(log2(abs(_3495 * 9.9999997473787516355514526367188e-05f)) * 0.1593017578125f);
    float _3517 = (_3496 == 0.0f) ? 0.0f : exp2(log2(abs(_3496 * 9.9999997473787516355514526367188e-05f)) * 0.1593017578125f);
    _3536 = exp2(log2(mad(_3517, 18.8515625f, 0.8359375f) / mad(_3517, 18.6875f, 1.0f)) * 78.84375f);
    _3537 = exp2(log2(mad(_3516, 18.8515625f, 0.8359375f) / mad(_3516, 18.6875f, 1.0f)) * 78.84375f);
    _3538 = exp2(log2(mad(_3515, 18.8515625f, 0.8359375f) / mad(_3515, 18.6875f, 1.0f)) * 78.84375f);

    color_output = float3(_3538, _3537, _3536);
  }
  //   u0[gl_GlobalInvocationID] = float4(saturate(float3(_3538, _3537, _3536)), 1.0f);
  u0[gl_GlobalInvocationID] = float4(saturate(color_output), 1.0f);
}

[numthreads(16, 16, 2)]
void main(SPIRV_Cross_Input stage_input) {
  gl_GlobalInvocationID = stage_input.gl_GlobalInvocationID;
  comp_main();
}
