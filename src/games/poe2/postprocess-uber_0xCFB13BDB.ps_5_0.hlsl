// ---- Created with 3Dmigoto v1.4.1 on Tue Dec  2 20:43:34 2025
#include "shared.h"
#include "./lilium_rcas.hlsl"

Texture3D<float4> t9 : register(t9); // Color Grading LUT

Texture3D<float4> t8 : register(t8); // Color Grading LUT

Texture3D<float4> t7 : register(t7); // Color Grading LUT

Texture2D<float4> t6 : register(t6); // Vignette / Mask?

Texture2D<float4> t5 : register(t5);

Texture2D<float4> t4 : register(t4);

Texture2D<float4> t3 : register(t3);

Texture2D<float4> t2 : register(t2); // Bloom

Texture2D<float4> t1 : register(t1); // Depth

Texture2D<float4> t0 : register(t0); // Scene Color

SamplerState s9_s : register(s9);

SamplerState s1_s : register(s1);

cbuffer cb0 : register(b0)
{
  float4 cb0[27];
}

// 3Dmigoto declarations
#define cmp -


void main(
  float4 v0 : SV_POSITION0,
  float2 v1 : TEXCOORD0,
  out float4 o0 : SV_TARGET0)
{
  float4 r0,r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16;
  uint4 bitmask, uiDest;
  float4 fDest;
  const float vignette_strength = saturate(CUSTOM_VIGNETTE_STRENGTH);

  // Pick the active render-target dimensions from the bound resources.
  uint buffer_width, buffer_height;
  t0.GetDimensions(buffer_width, buffer_height);
  float2 buffer_pixels = max(float2(buffer_width, buffer_height), float2(1.0, 1.0));
  float2 buffer_wz = buffer_pixels.yx;

  float2 viewport_pixels = max(float2(asint(cb0[0].xy)), float2(1.0, 1.0));
  r1.xy = v0.xy / viewport_pixels;
  r0.xy = viewport_pixels / buffer_pixels;
  r0.xy = cb0[26].yy ? float2(1,1) : r0.xy;
  float2 rect_scale = float2(asint(cb0[1].xy));
  float2 rect_offset = float2(asint(cb0[1].zw));
  float2 rect_scale_norm = rect_scale / buffer_pixels;
  float2 rect_offset_norm = rect_offset / buffer_pixels;
  r2.zw = r1.xy * r0.xy;
  r3.xyzw = t0.SampleLevel(s1_s, r2.zw, 0).xyzw;
  const float2 sharpen_uv = r2.zw;
  r2.xy = r1.xy * rect_scale_norm + rect_offset_norm;
  r0.zw = rect_offset_norm;
  r2.z = cmp(asint(cb0[21].y) == 0);
  r2.w = cmp(0 >= cb0[18].x);
  r2.z = (int)r2.w | (int)r2.z;
  if (r2.z != 0) {
    r2.z = dot(cb0[15].xy, cb0[15].xy);
    r2.z = sqrt(r2.z);
    r2.z = cmp(0.00100000005 < r2.z);
    if (r2.z != 0) {
      // Effect Block: Radial Blur / Bloom ?
      r2.zw = float2(-0.5,-0.5) + r1.xy;
      r4.x = dot(r2.zw, r2.zw);
      r4.y = rsqrt(r4.x);
      r5.xy = r4.yy * r2.zw;
      r5.z = -r5.y;
      r5.xyzw = cb0[15].xxyy * r5.xyzx;
      r2.zw = r5.xy + r5.zw;
      r4.x = sqrt(r4.x);
      r4.x = log2(r4.x);
      r4.x = cb0[15].z * r4.x;
      r4.x = exp2(r4.x);
      r2.zw = r4.xx * r2.zw;

      const int kBloomTaps = 6;
      float3 bloom_accum = float3(0, 0, 0);
      float bloom_weight_sum = 0;
      float jitter_seed = frac(sin(dot(v0.xy, float2(12.9898005,78.2330017))) * 43758.5469);
      float jitter_angle = jitter_seed * 6.28318548;
      float2 micro_jitter = float2(cos(jitter_angle), sin(jitter_angle)) * 0.0015;

      [unroll]
      for (int tap = 0; tap < kBloomTaps; ++tap) {
        float tap_offset = float(tap) - ((kBloomTaps - 1) * 0.5f);
        float normalized_offset = tap_offset / (((kBloomTaps - 1) * 0.5f) + 1.0e-05f);
        float tap_weight = exp2(-abs(normalized_offset) * 1.10000002f);
        float2 offset = r2.zw * (normalized_offset * 0.12f);
        float2 sample_uv = (r1.xy - offset + micro_jitter) * r0.xy;
        float3 tap_color = t0.SampleLevel(s1_s, sample_uv, 0).xyz;
        bloom_accum += tap_color * tap_weight;
        bloom_weight_sum += tap_weight;
      }

      r3.xyz = bloom_accum / bloom_weight_sum;
    }
  }
  if (cb0[21].w != 0) {
    r2.z = t1.SampleLevel(s1_s, r2.xy, 0).x;
    r0.xy = r1.xy * r0.xy + r0.zw;
    r0.z = r1.x * 2 + -1;
    r0.w = 1 + -r1.y;
    r0.w = r0.w * 2 + -1;
    r4.xy = cb0[11].zw * r0.ww;
    r0.zw = r0.zz * cb0[10].zw + r4.xy;
    r0.zw = r2.zz * cb0[12].zw + r0.zw;
    r0.zw = cb0[13].zw + r0.zw;
    r0.z = r0.z / r0.w;
    r4.xyz = t4.SampleLevel(s1_s, r0.xy, 0).xyz;
    r0.xyw = t3.SampleLevel(s1_s, r0.xy, 0).xyz;
    r2.z = cb0[22].w + cb0[22].z;
    r2.z = -r2.z + abs(r0.z);
    r2.z = saturate(r2.z / cb0[22].y);
    r2.z = 1 + -r2.z;
    r0.z = cb0[22].w + -abs(r0.z);
    r0.z = saturate(r0.z / cb0[22].x);
    r4.xyz = r3.xyz * float3(9.99999975e-05,9.99999975e-05,9.99999975e-05) + r4.xyz;
    r2.w = r2.z * -2 + 3;
    r2.z = r2.z * r2.z;
    r2.z = r2.w * r2.z;
    r5.xyz = -r4.xyz + r3.xyz;
    r4.xyz = r2.zzz * r5.xyz + r4.xyz;
    r0.xyw = r3.xyz * float3(9.99999975e-05,9.99999975e-05,9.99999975e-05) + r0.xyw;
    r2.z = r0.z * -2 + 3;
    r0.z = r0.z * r0.z;
    r0.z = r2.z * r0.z;
    r0.xyw = r0.xyw + -r4.xyz;
    r3.xyz = r0.zzz * r0.xyw + r4.xyz;
  }
  if (CUSTOM_SHARPNESS > 0.f) {
    r3.xyz = ApplyRCAS(r3.xyz, sharpen_uv, t0, s1_s);
  }
  r0.xyz = t2.SampleLevel(s9_s, r1.xy, 0).xyz;
  r0.xyz = r3.xyz * cb0[21].zzz + r0.xyz;
  r0.w = max(1, cb0[23].y);
  r3.xyz = r0.xyz * r0.www;

  // DLSS/DLAA sometimes zeroes cb0[23].zw even when grading controls remain active ??????
  float lut_activity = max(max(abs(cb0[24].x), abs(cb0[24].y)), max(abs(cb0[24].z), abs(cb0[24].w)));
  bool lut_controls_present = lut_activity > 1e-05;
  bool lut_pass1_enabled = (cb0[23].z != 0) || lut_controls_present;
  bool lut_pass2_enabled = (cb0[23].w != 0) || lut_controls_present;
  float3 color_before_lut = r3.xyz;

  if (lut_pass1_enabled) {
    // Color Grading: LUT Sampling (Pass 1)
    r2.x = t5.Sample(s1_s, r2.xy).x;
    r2.yzw = saturate(r3.xyz);
    r2.yzw = log2(r2.yzw);
    r2.yzw = float3(0.454545468,0.454545468,0.454545468) * r2.yzw;
    r2.yzw = exp2(r2.yzw);
    r2.yzw = t7.SampleLevel(s1_s, r2.yzw, 0).xyz;
    r2.x = saturate(r2.x);
    r0.xyz = -r0.xyz * r0.www + r2.yzw;
    r0.xyz = r2.xxx * r0.xyz + r3.xyz;
  }
  r0.xyz = lut_pass1_enabled ? r0.xyz : r3.xyz;
  if (lut_pass2_enabled) {
    // Color Grading: LUT Sampling (Pass 2)
    r0.w = max(r0.x, r0.y);
    r2.x = max(1, r0.z);
    r0.w = max(r2.x, r0.w);
    r2.xyz = saturate(r0.xyz / r0.www);
    r2.xyz = log2(r2.xyz);
    r2.xyz = float3(0.454545468,0.454545468,0.454545468) * r2.xyz;
    r2.xyz = exp2(r2.xyz);
    r3.xyz = t8.SampleLevel(s1_s, r2.xyz, 0).xyz;
    r2.xyz = t9.SampleLevel(s1_s, r2.xyz, 0).xyz;
    r2.xyz = r2.xyz + -r3.xyz;
    r2.xyz = cb0[23].xxx * r2.xyz + r3.xyz;
    r0.xyz = r2.xyz * r0.www;
  }
  float lut_strength = saturate(CUSTOM_LUT_STRENGTH);
  r0.xyz = lerp(color_before_lut, r0.xyz, lut_strength);
  float3 linear_untonemapped = r0.xyz;
  float3 graded_sdr_color = saturate(linear_untonemapped);
  r0.xyz = renodx::draw::ToneMapPass(linear_untonemapped, graded_sdr_color);
  r0.xyz = renodx::draw::RenderIntermediatePass(r0.xyz);
  if (CUSTOM_GRAIN_STRENGTH > 0.f) {
    r0.xyz = renodx::effects::ApplyFilmGrain(
        r0.xyz,
        v1.xy,
        CUSTOM_RANDOM,
        CUSTOM_GRAIN_STRENGTH * 0.03f);
  }
  r0.w = cmp(asint(cb0[24].y) == 1);
  if (r0.w != 0) {
    r0.w = -1;
  } else {
    r0.w = cmp(asint(cb0[24].y) == 2);
  }
  // Dithering / Noise Generation
  r2.x = dot(v0.xy, float2(12.9898005,78.2330017));
  r2.x = sin(r2.x);
  r2.x = 43758.5469 * r2.x;
  r2.x = frac(r2.x);
  r2.xyz = r2.xxx * float3(0.00100000005,0.00100000005,0.00100000005) + r0.xyz;
  r0.xyz = r0.xyz; //Removed dithering/grain bs
  r2.xy = float2(-0.5,-0.5) + r1.xy;
  r0.w = dot(r2.xy, r2.xy);
  r0.w = sqrt(r0.w);
  r0.w = 1.41421354 * r0.w;
  r0.w = -r0.w * r0.w + 1;
  r2.x = 1 + -r0.w;
  r0.w = r2.x * 0.150000006 + r0.w;
  float vignette_factor_inner = lerp(1.0f, r0.w, vignette_strength);
  r0.xyz = r0.xyz * vignette_factor_inner;
  r2.xyz = cb0[14].yyy * r0.xyz;
  r0.xyz = cb0[14].www ? r2.xyz : r0.xyz;
  r0.w = cmp(cb0[24].z < 9.99999975e-06);
  // force dithering/noise block off to remove always-on grain.
  r0.w = 1;
  if (r0.w != 0) {
    r2.xyz = r0.xyz;
  }
  if (r0.w == 0) {
    // Procedural Noise / Grain Generation (Massive Block)
    r4.xyzw = r1.xyxy * float4(2,2,2,2) + float4(-1,-1,-1,-1);
    r3.xy = float2(1.79999995,1.79999995) * r4.zw;
    r5.xyzw = float4(0.909999967,-1.29999995,0.140000001,-0.200000003) * cb0[14].xxxx;
    r5.xy = r4.zw * float2(1.79999995,1.79999995) + r5.xy;
    r6.xy = cb0[14].xx * float2(0.140000001,-0.200000003) + r5.xy;
    r6.xy = float2(9.16702843,8.56988335) + r6.xy;
    r6.zw = frac(r6.xy);
    r7.xy = r6.zw * float2(-2,-2) + float2(3,3);
    r6.zw = r6.zw * r6.zw;
    r6.zw = r7.xy * r6.zw;
    r6.xy = floor(r6.xy);
    r7.xyzw = float4(0,1,1,0) + r6.xyxy;
    r8.xy = float2(1,1) + r6.xy;
    r6.xy = mad((int2)r6.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r9.x = mad((int)r6.y, 0x3c6ef35f, (int)r6.x);
    r9.y = mad(0x3c6ef35f, (int)r9.x, (int)r6.y);
    r9.z = mad((int)r9.x, (int)r9.y, 0x3c6ef35f);
    r10.xyz = (uint3)r9.xyz >> int3(16,16,16);
    r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
    r0.w = mad((int)r9.y, (int)r9.z, (int)r9.x);
    r0.w = (uint)r0.w >> 9;
    r0.w = (int)r0.w + 0x3f800000;
    r0.w = -1 + r0.w;
    r7.xyzw = mad((int4)r7.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r9.xy = mad((int2)r7.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r7.xz);
    r7.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r9.xy, (int2)r7.yw);
    r6.xy = mad((int2)r9.xy, (int2)r7.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r9.z = r7.x;
    r9.w = r6.x;
    r10.xyz = (uint3)r9.xzw >> int3(16,16,16);
    r9.xzw = (int3)r9.xzw ^ (int3)r10.xyz;
    r2.w = mad((int)r9.z, (int)r9.w, (int)r9.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r7.z = r9.y;
    r7.w = r6.y;
    r9.xyz = (uint3)r7.zyw >> int3(16,16,16);
    r7.xyz = (int3)r7.zyw ^ (int3)r9.xyz;
    r3.z = mad((int)r7.y, (int)r7.z, (int)r7.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r6.xy = mad((int2)r8.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r7.x = mad((int)r6.y, 0x3c6ef35f, (int)r6.x);
    r7.y = mad(0x3c6ef35f, (int)r7.x, (int)r6.y);
    r7.z = mad((int)r7.x, (int)r7.y, 0x3c6ef35f);
    r8.xyz = (uint3)r7.xyz >> int3(16,16,16);
    r7.xyz = (int3)r7.xyz ^ (int3)r8.xyz;
    r6.x = mad((int)r7.y, (int)r7.z, (int)r7.x);
    r6.x = (uint)r6.x >> 9;
    r6.x = (int)r6.x + 0x3f800000;
    r6.x = -1 + r6.x;
    r2.w = r2.w + -r0.w;
    r0.w = r6.w * r2.w + r0.w;
    r2.w = r6.x + -r3.z;
    r2.w = r6.w * r2.w + r3.z;
    r2.w = r2.w + -r0.w;
    r0.w = r6.z * r2.w + r0.w;
    r5.xy = r5.xy * float2(1.70000005,1.70000005) + r5.zw;
    r5.xy = float2(18.429697,12.7618933) + r5.xy;
    r6.xy = frac(r5.xy);
    r6.zw = r6.xy * float2(-2,-2) + float2(3,3);
    r6.xy = r6.xy * r6.xy;
    r6.xy = r6.zw * r6.xy;
    r5.xy = floor(r5.xy);
    r7.xyzw = float4(0,1,1,0) + r5.xyxy;
    r6.zw = float2(1,1) + r5.xy;
    r5.xy = mad((int2)r5.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r8.x = mad((int)r5.y, 0x3c6ef35f, (int)r5.x);
    r8.y = mad(0x3c6ef35f, (int)r8.x, (int)r5.y);
    r8.z = mad((int)r8.x, (int)r8.y, 0x3c6ef35f);
    r9.xyz = (uint3)r8.xyz >> int3(16,16,16);
    r8.xyz = (int3)r8.xyz ^ (int3)r9.xyz;
    r2.w = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r7.xyzw = mad((int4)r7.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r8.xy = mad((int2)r7.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r7.xz);
    r7.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xy, (int2)r7.yw);
    r5.xy = mad((int2)r8.xy, (int2)r7.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r8.z = r7.x;
    r8.w = r5.x;
    r9.xyz = (uint3)r8.xzw >> int3(16,16,16);
    r8.xzw = (int3)r8.xzw ^ (int3)r9.xyz;
    r3.z = mad((int)r8.z, (int)r8.w, (int)r8.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r7.z = r8.y;
    r7.w = r5.y;
    r8.xyz = (uint3)r7.zyw >> int3(16,16,16);
    r7.xyz = (int3)r7.zyw ^ (int3)r8.xyz;
    r5.x = mad((int)r7.y, (int)r7.z, (int)r7.x);
    r5.x = (uint)r5.x >> 9;
    r5.x = (int)r5.x + 0x3f800000;
    r6.zw = mad((int2)r6.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r7.x = mad((int)r6.w, 0x3c6ef35f, (int)r6.z);
    r7.y = mad(0x3c6ef35f, (int)r7.x, (int)r6.w);
    r7.z = mad((int)r7.x, (int)r7.y, 0x3c6ef35f);
    r8.xyz = (uint3)r7.xyz >> int3(16,16,16);
    r7.xyz = (int3)r7.xyz ^ (int3)r8.xyz;
    r5.y = mad((int)r7.y, (int)r7.z, (int)r7.x);
    r5.y = (uint)r5.y >> 9;
    r5.y = (int)r5.y + 0x3f800000;
    r5.xy = float2(-1,-1) + r5.xy;
    r3.z = r3.z + -r2.w;
    r2.w = r6.y * r3.z + r2.w;
    r3.z = r5.y + -r5.x;
    r3.z = r6.y * r3.z + r5.x;
    r3.z = r3.z + -r2.w;
    r2.w = r6.x * r3.z + r2.w;
    r0.w = r2.w * 0.699999988 + r0.w;
    r0.w = 0.588235319 * r0.w;
    r2.w = r4.w * 1.79999995 + 0.5;
    r2.w = saturate(0.400000006 * r2.w);
    r3.z = r2.w * -2 + 3;
    r2.w = r2.w * r2.w;
    r2.w = -r3.z * r2.w + 0.75;
    r2.w = max(0, r2.w);
    r2.w = log2(r2.w);
    r2.w = 2.5 * r2.w;
    r2.w = exp2(r2.w);
    r5.xy = float2(-4,-1) + cb0[24].ww;
    r3.z = -r4.w * 1.79999995 + 2;
    r3.z = r5.x * r3.z + -6;
    r3.z = saturate(0.0714285746 * r3.z);
    r6.x = r3.z * -2 + 3;
    r3.z = r3.z * r3.z;
    r3.z = r6.x * r3.z;
    r2.w = r3.z * r2.w;
    r6.x = r2.w * r0.w;
    r6.yzw = float3(0.0450000018,0.00900000054,0.00450000027) * r6.xxx;
    r7.xyzw = float4(0.349999994,-0.5,1.5,0.25) * cb0[14].xxxx;
    r8.xyzw = r4.zwzw * float4(7.19999981,7.19999981,7.19999981,7.19999981) + r7.xyxy;
    r7.xy = cb0[14].xx * float2(0.140000001,-0.200000003) + r8.zw;
    r7.xy = float2(9.16702843,8.56988335) + r7.xy;
    r9.xy = frac(r7.xy);
    r9.zw = r9.xy * float2(-2,-2) + float2(3,3);
    r9.xy = r9.xy * r9.xy;
    r9.xy = r9.zw * r9.xy;
    r7.xy = floor(r7.xy);
    r10.xyzw = float4(0,1,1,0) + r7.xyxy;
    r9.zw = float2(1,1) + r7.xy;
    r7.xy = mad((int2)r7.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r11.x = mad((int)r7.y, 0x3c6ef35f, (int)r7.x);
    r11.y = mad(0x3c6ef35f, (int)r11.x, (int)r7.y);
    r11.z = mad((int)r11.x, (int)r11.y, 0x3c6ef35f);
    r12.xyz = (uint3)r11.xyz >> int3(16,16,16);
    r11.xyz = (int3)r11.xyz ^ (int3)r12.xyz;
    r0.w = mad((int)r11.y, (int)r11.z, (int)r11.x);
    r0.w = (uint)r0.w >> 9;
    r0.w = (int)r0.w + 0x3f800000;
    r0.w = -1 + r0.w;
    r10.xyzw = mad((int4)r10.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r11.xy = mad((int2)r10.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xz);
    r10.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r11.xy, (int2)r10.yw);
    r7.xy = mad((int2)r11.xy, (int2)r10.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r11.z = r10.x;
    r11.w = r7.x;
    r12.xyz = (uint3)r11.xzw >> int3(16,16,16);
    r11.xzw = (int3)r11.xzw ^ (int3)r12.xyz;
    r2.w = mad((int)r11.z, (int)r11.w, (int)r11.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r10.z = r11.y;
    r10.w = r7.y;
    r11.xyz = (uint3)r10.zyw >> int3(16,16,16);
    r10.xyz = (int3)r10.zyw ^ (int3)r11.xyz;
    r3.z = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r7.xy = mad((int2)r9.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r10.x = mad((int)r7.y, 0x3c6ef35f, (int)r7.x);
    r10.y = mad(0x3c6ef35f, (int)r10.x, (int)r7.y);
    r10.z = mad((int)r10.x, (int)r10.y, 0x3c6ef35f);
    r11.xyz = (uint3)r10.xyz >> int3(16,16,16);
    r10.xyz = (int3)r10.xyz ^ (int3)r11.xyz;
    r7.x = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r7.x = (uint)r7.x >> 9;
    r7.x = (int)r7.x + 0x3f800000;
    r7.x = -1 + r7.x;
    r2.w = r2.w + -r0.w;
    r0.w = r9.y * r2.w + r0.w;
    r2.w = r7.x + -r3.z;
    r2.w = r9.y * r2.w + r3.z;
    r2.w = r2.w + -r0.w;
    r0.w = r9.x * r2.w + r0.w;
    r8.xyzw = r8.xyzw * float4(1.79999995,1.79999995,3.23999977,3.23999977) + r5.zwzw;
    r8.xyzw = float4(14.6040554,11.7827311,20.6692505,18.0127373) + r8.xyzw;
    r9.xyzw = frac(r8.xyzw);
    r10.xyzw = r9.xyzw * float4(-2,-2,-2,-2) + float4(3,3,3,3);
    r9.xyzw = r9.xyzw * r9.xyzw;
    r9.xyzw = r10.xyzw * r9.xyzw;
    r8.xyzw = floor(r8.xyzw);
    r10.xyzw = float4(0,1,1,0) + r8.xyxy;
    r11.xyzw = float4(1,1,0,1) + r8.xyzw;
    r12.xyzw = mad((int4)r8.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r13.xy = mad((int2)r12.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r12.xz);
    r12.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r13.xy, (int2)r12.yw);
    r5.zw = mad((int2)r13.xy, (int2)r12.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r13.z = r12.x;
    r13.w = r5.z;
    r14.xyz = (uint3)r13.xzw >> int3(16,16,16);
    r13.xzw = (int3)r13.xzw ^ (int3)r14.xyz;
    r2.w = mad((int)r13.z, (int)r13.w, (int)r13.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r10.xyzw = mad((int4)r10.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r14.xy = mad((int2)r10.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xz);
    r10.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r14.xy, (int2)r10.yw);
    r7.xy = mad((int2)r14.xy, (int2)r10.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r14.z = r10.x;
    r14.w = r7.x;
    r13.xzw = (uint3)r14.xzw >> int3(16,16,16);
    r13.xzw = (int3)r13.xzw ^ (int3)r14.xzw;
    r3.z = mad((int)r13.z, (int)r13.w, (int)r13.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r10.z = r14.y;
    r10.w = r7.y;
    r13.xzw = (uint3)r10.zyw >> int3(16,16,16);
    r10.xyz = (int3)r10.zyw ^ (int3)r13.xzw;
    r5.z = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r5.z = -1 + r5.z;
    r10.xyzw = mad((int4)r11.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r11.xy = mad((int2)r10.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xz);
    r10.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r11.xy, (int2)r10.yw);
    r7.xy = mad((int2)r11.xy, (int2)r10.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r11.z = r10.x;
    r11.w = r7.x;
    r13.xzw = (uint3)r11.xzw >> int3(16,16,16);
    r11.xzw = (int3)r11.xzw ^ (int3)r13.xzw;
    r7.x = mad((int)r11.z, (int)r11.w, (int)r11.x);
    r7.x = (uint)r7.x >> 9;
    r7.x = (int)r7.x + 0x3f800000;
    r7.x = -1 + r7.x;
    r3.z = r3.z + -r2.w;
    r2.w = r9.y * r3.z + r2.w;
    r3.z = r7.x + -r5.z;
    r3.z = r9.y * r3.z + r5.z;
    r3.z = r3.z + -r2.w;
    r2.w = r9.x * r3.z + r2.w;
    r0.w = r2.w * 0.5 + r0.w;
    r8.xyzw = float4(1,0,1,1) + r8.zwzw;
    r12.z = r13.y;
    r12.w = r5.w;
    r11.xzw = (uint3)r12.zyw >> int3(16,16,16);
    r11.xzw = (int3)r11.xzw ^ (int3)r12.zyw;
    r2.w = mad((int)r11.z, (int)r11.w, (int)r11.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r10.z = r11.y;
    r10.w = r7.y;
    r11.xyz = (uint3)r10.zyw >> int3(16,16,16);
    r10.xyz = (int3)r10.zyw ^ (int3)r11.xyz;
    r3.z = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r8.xyzw = mad((int4)r8.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r10.xy = mad((int2)r8.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xz);
    r8.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xy, (int2)r8.yw);
    r5.zw = mad((int2)r10.xy, (int2)r8.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r10.z = r8.x;
    r10.w = r5.z;
    r11.xyz = (uint3)r10.xzw >> int3(16,16,16);
    r10.xzw = (int3)r10.xzw ^ (int3)r11.xyz;
    r5.z = mad((int)r10.z, (int)r10.w, (int)r10.x);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r8.z = r10.y;
    r8.w = r5.w;
    r10.xyz = (uint3)r8.zyw >> int3(16,16,16);
    r8.xyz = (int3)r8.zyw ^ (int3)r10.xyz;
    r5.w = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r5.w = (uint)r5.w >> 9;
    r5.w = (int)r5.w + 0x3f800000;
    r5.zw = float2(-1,-1) + r5.zw;
    r3.z = r3.z + -r2.w;
    r2.w = r9.w * r3.z + r2.w;
    r3.z = r5.w + -r5.z;
    r3.z = r9.w * r3.z + r5.z;
    r3.z = r3.z + -r2.w;
    r2.w = r9.z * r3.z + r2.w;
    r0.w = r2.w * 0.25 + r0.w;
    r0.w = 0.571428597 * r0.w;
    r0.w = r0.w * r0.w;
    r0.w = 1.5 * r0.w;
    r6.yzw = r6.yzw * r0.www;
    r6.yzw = cb0[24].zzz * r6.yzw;
    r0.w = saturate(r6.x * cb0[24].z + 1);
    r4.xy = float2(1.43999994,1.43999994) * r4.xy;
    r5.zw = frac(r4.xy);
    r7.xy = r5.zw * float2(-2,-2) + float2(3,3);
    r5.zw = r5.zw * r5.zw;
    r5.zw = r7.xy * r5.zw;
    r4.xy = floor(r4.xy);
    r8.xyzw = float4(0,1,1,0) + r4.xyxy;
    r7.xy = float2(1,1) + r4.xy;
    r4.xy = mad((int2)r4.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r9.x = mad((int)r4.y, 0x3c6ef35f, (int)r4.x);
    r9.y = mad(0x3c6ef35f, (int)r9.x, (int)r4.y);
    r9.z = mad((int)r9.x, (int)r9.y, 0x3c6ef35f);
    r10.xyz = (uint3)r9.xyz >> int3(16,16,16);
    r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
    r2.w = mad((int)r9.y, (int)r9.z, (int)r9.x);
    r2.w = (uint)r2.w >> 9;
    r2.w = (int)r2.w + 0x3f800000;
    r2.w = -1 + r2.w;
    r8.xyzw = mad((int4)r8.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r9.xy = mad((int2)r8.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xz);
    r8.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r9.xy, (int2)r8.yw);
    r4.xy = mad((int2)r9.xy, (int2)r8.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r9.z = r8.x;
    r9.w = r4.x;
    r10.xyz = (uint3)r9.xzw >> int3(16,16,16);
    r9.xzw = (int3)r9.xzw ^ (int3)r10.xyz;
    r3.z = mad((int)r9.z, (int)r9.w, (int)r9.x);
    r3.z = (uint)r3.z >> 9;
    r3.z = (int)r3.z + 0x3f800000;
    r3.z = -1 + r3.z;
    r8.z = r9.y;
    r8.w = r4.y;
    r9.xyz = (uint3)r8.zyw >> int3(16,16,16);
    r8.xyz = (int3)r8.zyw ^ (int3)r9.xyz;
    r4.x = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r4.x = (uint)r4.x >> 9;
    r4.x = (int)r4.x + 0x3f800000;
    r7.xy = mad((int2)r7.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r8.x = mad((int)r7.y, 0x3c6ef35f, (int)r7.x);
    r8.y = mad(0x3c6ef35f, (int)r8.x, (int)r7.y);
    r8.z = mad((int)r8.x, (int)r8.y, 0x3c6ef35f);
    r9.xyz = (uint3)r8.xyz >> int3(16,16,16);
    r8.xyz = (int3)r8.xyz ^ (int3)r9.xyz;
    r4.y = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r4.y = (uint)r4.y >> 9;
    r4.y = (int)r4.y + 0x3f800000;
    r4.xy = float2(-1,-1) + r4.xy;
    r3.z = r3.z + -r2.w;
    r2.w = r5.w * r3.z + r2.w;
    r3.z = r4.y + -r4.x;
    r3.z = r5.w * r3.z + r4.x;
    r3.z = r3.z + -r2.w;
    r2.w = r5.z * r3.z + r2.w;
    r4.xy = float2(0.699999988,-1) * r5.xx;
    r2.w = -7 + r2.w;
    r6.x = saturate(r6.x);
    r3.z = r6.x * -2 + 3;
    r5.x = r6.x * r6.x;
    r3.z = r5.x * r3.z;
    r8.xyzw = float4(0,0,0,0);
    r5.xzw = float3(0.522619486,8.81068325,1.15999997);
    r6.x = 0.730000019;
    r7.x = 0;
    while (true) {
      r7.y = cmp((uint)r7.x >= 4);
      if (r7.y != 0) break;
      r9.xy = r5.ww * r3.xy;
      r9.xy = r9.xy * float2(2,2) + float2(0.5,0.5);
      r9.zw = frac(r9.xy);
      r10.xy = r9.zw * float2(-2,-2) + float2(3,3);
      r9.zw = r9.zw * r9.zw;
      r9.zw = r10.xy * r9.zw;
      r9.xy = floor(r9.xy);
      r10.xyzw = float4(0,1,1,0) + r9.xyxy;
      r11.xy = float2(1,1) + r9.xy;
      r9.xy = mad((int2)r9.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r12.x = mad((int)r9.y, 0x3c6ef35f, (int)r9.x);
      r12.y = mad(0x3c6ef35f, (int)r12.x, (int)r9.y);
      r12.z = mad((int)r12.x, (int)r12.y, 0x3c6ef35f);
      r13.xyz = (uint3)r12.xyz >> int3(16,16,16);
      r12.xyz = (int3)r12.xyz ^ (int3)r13.xyz;
      r7.y = mad((int)r12.y, (int)r12.z, (int)r12.x);
      r9.x = mad((int)r12.z, (int)r7.y, (int)r12.y);
      r7.y = mad((int)r7.y, (int)r9.x, (int)r12.z);
      r9.x = (uint)r9.x >> 9;
      r9.x = (int)r9.x + 0x3f800000;
      r9.x = -1 + r9.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r9.y = -1 + r7.y;
      r10.xyzw = mad((int4)r10.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
      r12.xy = mad((int2)r10.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xz);
      r10.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r12.xy, (int2)r10.yw);
      r11.zw = mad((int2)r12.xy, (int2)r10.xy, int2(0x3c6ef35f,0x3c6ef35f));
      r12.z = r10.x;
      r12.w = r11.z;
      r13.xyz = (uint3)r12.xzw >> int3(16,16,16);
      r12.xzw = (int3)r12.xzw ^ (int3)r13.xyz;
      r7.y = mad((int)r12.z, (int)r12.w, (int)r12.x);
      r10.x = mad((int)r12.w, (int)r7.y, (int)r12.z);
      r7.y = mad((int)r7.y, (int)r10.x, (int)r12.w);
      r10.x = (uint)r10.x >> 9;
      r10.x = (int)r10.x + 0x3f800000;
      r13.x = -1 + r10.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r13.y = -1 + r7.y;
      r10.z = r12.y;
      r10.w = r11.w;
      r12.xyz = (uint3)r10.zyw >> int3(16,16,16);
      r10.xyz = (int3)r10.zyw ^ (int3)r12.xyz;
      r7.y = mad((int)r10.y, (int)r10.z, (int)r10.x);
      r10.x = mad((int)r10.z, (int)r7.y, (int)r10.y);
      r7.y = mad((int)r7.y, (int)r10.x, (int)r10.z);
      r10.x = (uint)r10.x >> 9;
      r10.x = (int)r10.x + 0x3f800000;
      r10.x = -1 + r10.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r10.y = -1 + r7.y;
      r10.zw = mad((int2)r11.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r11.x = mad((int)r10.w, 0x3c6ef35f, (int)r10.z);
      r11.y = mad(0x3c6ef35f, (int)r11.x, (int)r10.w);
      r11.z = mad((int)r11.x, (int)r11.y, 0x3c6ef35f);
      r12.xyz = (uint3)r11.xyz >> int3(16,16,16);
      r11.xyz = (int3)r11.xyz ^ (int3)r12.xyz;
      r7.y = mad((int)r11.y, (int)r11.z, (int)r11.x);
      r10.z = mad((int)r11.z, (int)r7.y, (int)r11.y);
      r7.y = mad((int)r7.y, (int)r10.z, (int)r11.z);
      r10.z = (uint)r10.z >> 9;
      r10.z = (int)r10.z + 0x3f800000;
      r11.x = -1 + r10.z;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r11.y = -1 + r7.y;
      r10.zw = r13.xy + -r9.xy;
      r9.xy = r9.ww * r10.zw + r9.xy;
      r10.zw = r11.xy + -r10.xy;
      r10.xy = r9.ww * r10.zw + r10.xy;
      r10.xy = r10.xy + -r9.xy;
      r9.xy = r9.zz * r10.xy + r9.xy;
      r9.xy = float2(-0.5,-0.5) + r9.xy;
      r9.zw = r3.xy * r5.ww + r4.xy;
      r10.xy = r9.zw + r5.xz;
      r9.xy = r9.xy * float2(0.150000006,0.150000006) + r10.xy;
      r10.xy = floor(r9.xy);
      r10.zw = mad((int2)r10.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r11.x = mad((int)r10.w, 0x3c6ef35f, (int)r10.z);
      r11.y = mad(0x3c6ef35f, (int)r11.x, (int)r10.w);
      r11.z = mad((int)r11.x, (int)r11.y, 0x3c6ef35f);
      r12.xyz = (uint3)r11.xyz >> int3(16,16,16);
      r11.xyz = (int3)r11.xyz ^ (int3)r12.xyz;
      r7.y = mad((int)r11.y, (int)r11.z, (int)r11.x);
      r9.z = (uint)r7.y >> 9;
      r9.z = (int)r9.z + 0x3f800000;
      r9.z = -1.5 + r9.z;
      r10.z = dot(r7.zz, r9.zz);
      r10.w = mad((int)r11.z, (int)r7.y, (int)r11.y);
      r7.y = mad((int)r7.y, (int)r10.w, (int)r11.z);
      r10.w = (uint)r10.w >> 9;
      r11.xz = (int2)r10.ww + int2(0x3f800000,0x3f800000);
      r7.y = (uint)r7.y >> 9;
      r11.yw = (int2)r7.yy + int2(0x3f800000,0x3f800000);
      r11.xyzw = float4(-1.5,-1.5,-1.5,-1.5) + r11.xyzw;
      sincos(r10.z, r12.x, r13.x);
      r14.x = -r13.x;
      r14.y = r12.x;
      r14.z = r13.x;
      r12.x = dot(r14.yz, r11.zw);
      r12.y = dot(r14.xy, r11.zw);
      r10.zw = r12.xy * float2(0.666666687,0.666666687) + r10.xy;
      r10.zw = float2(0.5,0.5) + r10.zw;
      r12.xy = r9.xy + r9.xy;
      r12.zw = frac(r12.xy);
      r13.xy = r12.zw * float2(-2,-2) + float2(3,3);
      r12.zw = r12.zw * r12.zw;
      r12.zw = r13.xy * r12.zw;
      r12.xy = floor(r12.xy);
      r13.xyzw = float4(0,1,1,0) + r12.xyxy;
      r14.xy = float2(1,1) + r12.xy;
      r12.xy = mad((int2)r12.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r15.x = mad((int)r12.y, 0x3c6ef35f, (int)r12.x);
      r15.y = mad(0x3c6ef35f, (int)r15.x, (int)r12.y);
      r15.z = mad((int)r15.x, (int)r15.y, 0x3c6ef35f);
      r16.xyz = (uint3)r15.xyz >> int3(16,16,16);
      r15.xyz = (int3)r15.xyz ^ (int3)r16.xyz;
      r7.y = mad((int)r15.y, (int)r15.z, (int)r15.x);
      r12.x = mad((int)r15.z, (int)r7.y, (int)r15.y);
      r7.y = mad((int)r7.y, (int)r12.x, (int)r15.z);
      r12.x = (uint)r12.x >> 9;
      r12.x = (int)r12.x + 0x3f800000;
      r12.x = -1 + r12.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r12.y = -1 + r7.y;
      r13.xyzw = mad((int4)r13.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
      r15.xy = mad((int2)r13.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r13.xz);
      r13.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r15.xy, (int2)r13.yw);
      r14.zw = mad((int2)r15.xy, (int2)r13.xy, int2(0x3c6ef35f,0x3c6ef35f));
      r15.z = r13.x;
      r15.w = r14.z;
      r16.xyz = (uint3)r15.xzw >> int3(16,16,16);
      r15.xzw = (int3)r15.xzw ^ (int3)r16.xyz;
      r7.y = mad((int)r15.z, (int)r15.w, (int)r15.x);
      r13.x = mad((int)r15.w, (int)r7.y, (int)r15.z);
      r7.y = mad((int)r7.y, (int)r13.x, (int)r15.w);
      r13.x = (uint)r13.x >> 9;
      r13.x = (int)r13.x + 0x3f800000;
      r16.x = -1 + r13.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r16.y = -1 + r7.y;
      r13.z = r15.y;
      r13.w = r14.w;
      r15.xyz = (uint3)r13.zyw >> int3(16,16,16);
      r13.xyz = (int3)r13.zyw ^ (int3)r15.xyz;
      r7.y = mad((int)r13.y, (int)r13.z, (int)r13.x);
      r13.x = mad((int)r13.z, (int)r7.y, (int)r13.y);
      r7.y = mad((int)r7.y, (int)r13.x, (int)r13.z);
      r13.x = (uint)r13.x >> 9;
      r13.x = (int)r13.x + 0x3f800000;
      r13.x = -1 + r13.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r13.y = -1 + r7.y;
      r13.zw = mad((int2)r14.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r14.x = mad((int)r13.w, 0x3c6ef35f, (int)r13.z);
      r14.y = mad(0x3c6ef35f, (int)r14.x, (int)r13.w);
      r14.z = mad((int)r14.x, (int)r14.y, 0x3c6ef35f);
      r15.xyz = (uint3)r14.xyz >> int3(16,16,16);
      r14.xyz = (int3)r14.xyz ^ (int3)r15.xyz;
      r7.y = mad((int)r14.y, (int)r14.z, (int)r14.x);
      r13.z = mad((int)r14.z, (int)r7.y, (int)r14.y);
      r7.y = mad((int)r7.y, (int)r13.z, (int)r14.z);
      r13.z = (uint)r13.z >> 9;
      r13.z = (int)r13.z + 0x3f800000;
      r14.x = -1 + r13.z;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r14.y = -1 + r7.y;
      r13.zw = r16.xy + -r12.xy;
      r12.xy = r12.ww * r13.zw + r12.xy;
      r13.zw = r14.xy + -r13.xy;
      r13.xy = r12.ww * r13.zw + r13.xy;
      r13.xy = r13.xy + -r12.xy;
      r12.xy = r12.zz * r13.xy + r12.xy;
      r12.xy = float2(-0.5,-0.5) + r12.xy;
      r12.xy = r12.xy * float2(0.100000001,0.100000001) + r9.xy;
      r9.xy = r9.xy * float2(3,3) + cb0[14].xx;
      r12.zw = frac(r9.xy);
      r13.xy = r12.zw * float2(-2,-2) + float2(3,3);
      r12.zw = r12.zw * r12.zw;
      r12.zw = r13.xy * r12.zw;
      r9.xy = floor(r9.xy);
      r13.xyzw = float4(0,1,1,0) + r9.xyxy;
      r14.xy = float2(1,1) + r9.xy;
      r9.xy = mad((int2)r9.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r15.x = mad((int)r9.y, 0x3c6ef35f, (int)r9.x);
      r15.y = mad(0x3c6ef35f, (int)r15.x, (int)r9.y);
      r15.z = mad((int)r15.x, (int)r15.y, 0x3c6ef35f);
      r16.xyz = (uint3)r15.xyz >> int3(16,16,16);
      r15.xyz = (int3)r15.xyz ^ (int3)r16.xyz;
      r7.y = mad((int)r15.y, (int)r15.z, (int)r15.x);
      r9.x = mad((int)r15.z, (int)r7.y, (int)r15.y);
      r7.y = mad((int)r7.y, (int)r9.x, (int)r15.z);
      r9.x = (uint)r9.x >> 9;
      r9.x = (int)r9.x + 0x3f800000;
      r9.x = -1 + r9.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r9.y = -1 + r7.y;
      r13.xyzw = mad((int4)r13.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
      r15.xy = mad((int2)r13.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r13.xz);
      r13.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r15.xy, (int2)r13.yw);
      r14.zw = mad((int2)r15.xy, (int2)r13.xy, int2(0x3c6ef35f,0x3c6ef35f));
      r15.z = r13.x;
      r15.w = r14.z;
      r16.xyz = (uint3)r15.xzw >> int3(16,16,16);
      r15.xzw = (int3)r15.xzw ^ (int3)r16.xyz;
      r7.y = mad((int)r15.z, (int)r15.w, (int)r15.x);
      r13.x = mad((int)r15.w, (int)r7.y, (int)r15.z);
      r7.y = mad((int)r7.y, (int)r13.x, (int)r15.w);
      r13.x = (uint)r13.x >> 9;
      r13.x = (int)r13.x + 0x3f800000;
      r16.x = -1 + r13.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r16.y = -1 + r7.y;
      r13.z = r15.y;
      r13.w = r14.w;
      r15.xyz = (uint3)r13.zyw >> int3(16,16,16);
      r13.xyz = (int3)r13.zyw ^ (int3)r15.xyz;
      r7.y = mad((int)r13.y, (int)r13.z, (int)r13.x);
      r13.x = mad((int)r13.z, (int)r7.y, (int)r13.y);
      r7.y = mad((int)r7.y, (int)r13.x, (int)r13.z);
      r13.x = (uint)r13.x >> 9;
      r13.x = (int)r13.x + 0x3f800000;
      r13.x = -1 + r13.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r13.y = -1 + r7.y;
      r13.zw = mad((int2)r14.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r14.x = mad((int)r13.w, 0x3c6ef35f, (int)r13.z);
      r14.y = mad(0x3c6ef35f, (int)r14.x, (int)r13.w);
      r14.z = mad((int)r14.x, (int)r14.y, 0x3c6ef35f);
      r15.xyz = (uint3)r14.xyz >> int3(16,16,16);
      r14.xyz = (int3)r14.xyz ^ (int3)r15.xyz;
      r7.y = mad((int)r14.y, (int)r14.z, (int)r14.x);
      r13.z = mad((int)r14.z, (int)r7.y, (int)r14.y);
      r7.y = mad((int)r7.y, (int)r13.z, (int)r14.z);
      r13.z = (uint)r13.z >> 9;
      r13.z = (int)r13.z + 0x3f800000;
      r14.x = -1 + r13.z;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r14.y = -1 + r7.y;
      r13.zw = r16.xy + -r9.xy;
      r9.xy = r12.ww * r13.zw + r9.xy;
      r13.zw = r14.xy + -r13.xy;
      r13.xy = r12.ww * r13.zw + r13.xy;
      r13.xy = r13.xy + -r9.xy;
      r9.xy = r12.zz * r13.xy + r9.xy;
      r9.xy = float2(-0.5,-0.5) + r9.xy;
      r9.xy = -r9.xy * float2(0.0700000003,0.0700000003) + r12.xy;
      r9.xy = r9.xy + -r10.zw;
      r12.x = dot(float2(0.64421767,0.764842212), r9.xy);
      r12.y = dot(float2(-0.764842212,0.64421767), r9.xy);
      r11.xyzw = r11.xyzw * float4(0.400000006,0.200000003,0.400000006,0.200000003) + float4(2.0999999,1.04999995,0.800000012,0.5);
      r10.zw = r12.xy * r11.xy;
      r7.y = dot(r10.zw, r10.zw);
      r7.y = sqrt(r7.y);
      r11.x = dot(float2(0.64421767,0.764842212), r9.xy);
      r11.y = dot(float2(-0.764842212,0.64421767), r9.xy);
      r9.xy = r11.xy * r11.zw;
      r9.x = dot(r9.xy, r9.xy);
      r9.x = sqrt(r9.x);
      r7.y = -0.000600000028 + r7.y;
      r7.y = saturate(416.666656 * r7.y);
      r9.y = r7.y * -2 + 3;
      r7.y = r7.y * r7.y;
      r7.y = -r9.y * r7.y + 1;
      r11.xyz = float3(10,2,1.25) * r7.yyy;
      r11.w = max(0, r7.y);
      r7.y = -721.347473 * r9.x;
      r7.y = exp2(r7.y);
      r7.y = -6.14421242e-06 + r7.y;
      r12.w = max(0, r7.y);
      r7.y = r12.w * r12.w;
      r12.xyz = float3(22.75,2.76250005,0.324999988) * r7.yyy;
      r11.xyzw = r12.xyzw + r11.xyzw;
      r7.y = -r9.z * 2.5 + r3.y;
      r7.y = saturate(r7.y + r7.y);
      r9.x = r7.y * -2 + 3;
      r7.y = r7.y * r7.y;
      r7.y = -r9.x * r7.y + 1;
      r9.xy = float2(0.214000002,0.214000002) + r10.xy;
      r9.xy = mad((int2)r9.xy, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
      r10.x = mad((int)r9.y, 0x3c6ef35f, (int)r9.x);
      r10.y = mad(0x3c6ef35f, (int)r10.x, (int)r9.y);
      r10.z = mad((int)r10.x, (int)r10.y, 0x3c6ef35f);
      r9.xyz = (uint3)r10.xyz >> int3(16,16,16);
      r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
      r9.x = mad((int)r9.y, (int)r9.z, (int)r9.x);
      r9.x = (uint)r9.x >> 9;
      r9.x = (int)r9.x + 0x3f800000;
      r9.x = -2.79999995 + r9.x;
      r9.x = -r9.x * 1.29999995 + r3.y;
      r9.x = saturate(r9.x + r9.x);
      r9.y = r9.x * -2 + 3;
      r9.x = r9.x * r9.x;
      r9.x = r9.y * r9.x;
      r7.y = r9.x * r7.y;
      r10.xyzw = r11.xyzw * r7.yyyy;
      r7.y = r9.w + -r2.w;
      r7.y = saturate(0.666666687 * r7.y);
      r9.x = r7.y * -2 + 3;
      r7.y = r7.y * r7.y;
      r7.y = -r9.x * r7.y + 1;
      r9.xyzw = r10.xyzw * r7.yyyy;
      r7.y = (uint)r7.x;
      r7.y = r7.y * r3.z;
      r7.y = -r7.y * 0.25 + 1;
      r7.y = r7.y * r6.x;
      r10.xyzw = r9.wxyz * r7.yyyy;
      r10.x = saturate(r10.x);
      r9.x = 1 + -r10.x;
      r8.xyz = r8.xyz * r9.xxx + r10.yzw;
      r8.w = saturate(r9.w * r7.y + r8.w);
      r7.y = (int)r6.x * 0x0019660d;
      r9.xy = mad((int2)r7.yy, int2(0x3c6ef360,0xd17070a1), int2(0xd17070a0,0x94d09ebf));
      r9.z = mad((int)r9.x, (int)r9.y, 0x3c6ef35f);
      r10.xyz = (uint3)r9.xyz >> int3(16,16,16);
      r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
      r7.y = mad((int)r9.y, (int)r9.z, (int)r9.x);
      r9.x = mad((int)r9.z, (int)r7.y, (int)r9.y);
      r7.y = mad((int)r7.y, (int)r9.x, (int)r9.z);
      r9.x = (uint)r9.x >> 9;
      r9.x = (int)r9.x + 0x3f800000;
      r9.x = -1 + r9.x;
      r7.y = (uint)r7.y >> 9;
      r7.y = (int)r7.y + 0x3f800000;
      r9.y = -1 + r7.y;
      r5.xz = r9.xy * float2(10,10) + r5.xz;
      r6.x = 0.728999972 * r6.x;
      r5.w = 1.15762496 * r5.w;
      r7.x = (int)r7.x + 1;
    }
    r9.xyzw = cb0[24].zzzz * r8.wxyz;
    r9.x = saturate(r9.x);
    r3.x = 1 + -r9.x;
    r5.xzw = r6.yzw * r3.xxx + r9.yzw;
    r0.w = saturate(r8.w * cb0[24].z + r0.w);
    r6.xyzw = float4(-0.479299992,-0.520699978,-0.5,-0.5) + r1.xxyy;
    r3.xz = buffer_wz;
    r7.y = r3.x / r3.z;
    r3.xz = float2(1,20) * r6.yz;
    r7.x = 20;
    r3.xz = r3.xz * r7.xy;
    r6.z = frac(r7.w);
    r6.z = 6.28318548 * r6.z;
    sincos(r6.z, r7.x, r8.x);
    r9.x = -r8.x;
    r9.y = r7.x;
    r9.z = r8.x;
    r8.x = dot(r9.yz, r3.xz);
    r8.y = dot(r9.xy, r3.xz);
    r3.x = max(abs(r8.x), abs(r8.y));
    r3.x = -0.5 + r3.x;
    r9.x = ddx_coarse(r3.x);
    r9.y = ddy_coarse(r3.x);
    r3.z = dot(r9.xy, r9.xy);
    r3.z = sqrt(r3.z);
    r3.z = max(1.00000001e-07, r3.z);
    r3.x = saturate(r3.x / r3.z);
    r3.x = 1 + -r3.x;
    r7.xw = float2(0.5,0.5) + r8.xy;
    r8.xyzw = t6.Sample(s1_s, r7.xw).xyzw;
    r3.z = saturate(r8.w);
    r6.z = r3.z * -2 + 3;
    r3.z = r3.z * r3.z;
    r3.z = r6.z * r3.z;
    r1.z = 0.200000003 * r3.z;
    r9.xyz = ddx_coarse(r1.yzx);
    r10.xyz = ddy_coarse(r1.yzx);
    r3.z = r10.z * r9.x;
    r3.z = r9.z * r10.x + -r3.z;
    r6.z = cmp(0 < abs(r3.z));
    r3.z = r6.z ? r3.z : 1.00000001e-07;
    r11.xz = float2(1,-1) * r10.xz;
    r11.yw = float2(-1,1) * r9.xz;
    r11.xyzw = r11.xyzw / r3.zzzz;
    r12.xyz = r11.yyy * r10.yzx;
    r12.xyz = r11.xxx * r9.yzx + r12.xyz;
    r10.xyz = r11.www * r10.xyz;
    r9.xyz = r11.zzz * r9.xyz + r10.xyz;
    r10.xyz = r12.xyz * r9.xyz;
    r9.xyz = r12.zxy * r9.yzx + -r10.xyz;
    r3.z = dot(r9.xyz, r9.xyz);
    r3.z = sqrt(r3.z);
    r3.z = max(1.00000001e-07, r3.z);
    r9.xyz = r9.xyz / r3.zzz;
    r10.xyz = float3(0.200000003,0.800000012,4) + -r1.xyz;
    r3.z = dot(r10.xyz, r10.xyz);
    r3.z = rsqrt(r3.z);
    r12.xyz = r10.xyz * r3.zzz;
    r1.w = 0;
    r13.xyz = float3(0.5,0.5,1) + -r1.xyw;
    r1.w = dot(r13.xyz, r13.xyz);
    r1.w = rsqrt(r1.w);
    r13.xyz = r13.xyz * r1.www;
    r10.xyz = r10.xyz * r3.zzz + r13.xyz;
    r1.w = dot(r10.xyz, r10.xyz);
    r1.w = rsqrt(r1.w);
    r10.xyz = r10.xyz * r1.www;
    r1.w = saturate(dot(r9.xyz, r12.xyz));
    r12.xyz = r8.xyz * r1.www;
    r1.w = saturate(dot(r9.xyz, r10.xyz));
    r8.xyz = r8.xyz * r1.www;
    r8.xyz = float3(0.800000012,0.800000012,0.800000012) * r8.xyz;
    r1.w = saturate(r5.y + r5.y);
    r3.z = r1.w * -2 + 3;
    r1.w = r1.w * r1.w;
    r1.w = r3.z * r1.w;
    r9.xyz = r12.xyz * float3(0.800000012,0.800000012,0.800000012) + r8.xyz;
    r9.w = 1;
    r8.xyzw = r9.xyzw * r8.wwww;
    r8.xyzw = r8.xyzw * r3.xxxx;
    r6.y = r7.y * r6.w;
    r3.xz = float2(20,20) * r6.xy;
    r5.y = -0.25 * cb0[14].x;
    r5.y = frac(r5.y);
    r5.y = -0.064000003 + r5.y;
    r5.y = 6.28318548 * r5.y;
    sincos(r5.y, r6.x, r7.x);
    r9.x = -r7.x;
    r9.y = r6.x;
    r9.z = r7.x;
    r6.x = dot(r9.yz, r3.xz);
    r6.y = dot(r9.xy, r3.xz);
    r3.x = max(abs(r6.x), abs(r6.y));
    r3.x = -0.5 + r3.x;
    r7.x = ddx_coarse(r3.x);
    r7.y = ddy_coarse(r3.x);
    r3.z = dot(r7.xy, r7.xy);
    r3.z = sqrt(r3.z);
    r3.z = max(1.00000001e-07, r3.z);
    r3.x = saturate(r3.x / r3.z);
    r3.x = 1 + -r3.x;
    r6.xy = float2(0.5,0.5) + r6.xy;
    r6.xyzw = t6.Sample(s1_s, r6.xy).xyzw;
    r3.z = saturate(r6.w);
    r5.y = r3.z * -2 + 3;
    r3.z = r3.z * r3.z;
    r3.z = r5.y * r3.z;
    r1.z = 0.200000003 * r3.z;
    r9.xz = ddx_coarse(r1.yx);
    r9.y = ddx_coarse(r1.z);
    r10.xz = ddy_coarse(r1.yx);
    r10.y = ddy_coarse(r1.z);
    r7.xyw = r11.yyy * r10.yzx;
    r7.xyw = r11.xxx * r9.yzx + r7.xyw;
    r10.xyz = r11.www * r10.xyz;
    r9.xyz = r11.zzz * r9.xyz + r10.xyz;
    r10.xyz = r9.xyz * r7.xyw;
    r7.xyw = r7.wxy * r9.yzx + -r10.xyz;
    r3.z = dot(r7.xyw, r7.xyw);
    r3.z = sqrt(r3.z);
    r3.z = max(1.00000001e-07, r3.z);
    r7.xyw = r7.xyw / r3.zzz;
    r1.xyz = float3(0.200000003,0.800000012,4) + -r1.xyz;
    r3.z = dot(r1.xyz, r1.xyz);
    r3.z = rsqrt(r3.z);
    r9.xyz = r3.zzz * r1.xyz;
    r1.xyz = r1.xyz * r3.zzz + r13.xyz;
    r3.z = dot(r1.xyz, r1.xyz);
    r3.z = rsqrt(r3.z);
    r1.xyz = r3.zzz * r1.xyz;
    r3.z = saturate(dot(r7.xyw, r9.xyz));
    r9.xyz = r6.xyz * r3.zzz;
    r1.x = saturate(dot(r7.xyw, r1.xyz));
    r1.xyz = r6.xyz * r1.xxx;
    r1.xyz = float3(0.800000012,0.800000012,0.800000012) * r1.xyz;
    r9.xyz = r9.xyz * float3(0.800000012,0.800000012,0.800000012) + r1.xyz;
    r9.w = 1;
    r6.xyzw = r9.xyzw * r6.wwww;
    r6.xyzw = r6.xyzw * r3.xxxx;
    r6.xyzw = r6.xyzw * r1.wwww;
    r6.xyzw = float4(0.699999988,0.699999988,0.699999988,1) * r6.xyzw;
    r1.xyzw = r8.xyzw * r1.wwww + r6.xyzw;
    r3.x = saturate(r1.w);
    r3.x = 1 + -r3.x;
    r1.xyz = r5.xzw * r3.xxx + r1.xyz;
    r0.w = saturate(r1.w + r0.w);
    r3.xz = r4.zw * float2(3.5999999,3.5999999) + float2(0.5,0.5);
    r5.xy = frac(r3.xz);
    r5.zw = r5.xy * float2(-2,-2) + float2(3,3);
    r5.xy = r5.xy * r5.xy;
    r5.xy = r5.zw * r5.xy;
    r3.xz = floor(r3.xz);
    r6.xyzw = float4(0,1,1,0) + r3.xzxz;
    r5.zw = float2(1,1) + r3.xz;
    r3.xz = mad((int2)r3.xz, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r8.x = mad((int)r3.z, 0x3c6ef35f, (int)r3.x);
    r8.y = mad(0x3c6ef35f, (int)r8.x, (int)r3.z);
    r8.z = mad((int)r8.x, (int)r8.y, 0x3c6ef35f);
    r7.xyw = (uint3)r8.xyz >> int3(16,16,16);
    r7.xyw = (int3)r7.xyw ^ (int3)r8.xyz;
    r1.w = mad((int)r7.y, (int)r7.w, (int)r7.x);
    r3.x = mad((int)r7.w, (int)r1.w, (int)r7.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r7.w);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r7.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r7.y = -1 + r1.w;
    r6.xyzw = mad((int4)r6.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r8.xy = mad((int2)r6.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r6.xz);
    r6.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xy, (int2)r6.yw);
    r3.xz = mad((int2)r8.xy, (int2)r6.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r8.z = r6.x;
    r8.w = r3.x;
    r9.xyz = (uint3)r8.xzw >> int3(16,16,16);
    r8.xzw = (int3)r8.xzw ^ (int3)r9.xyz;
    r1.w = mad((int)r8.z, (int)r8.w, (int)r8.x);
    r3.x = mad((int)r8.w, (int)r1.w, (int)r8.z);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r8.w);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r9.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r9.y = -1 + r1.w;
    r6.z = r8.y;
    r6.w = r3.z;
    r8.xyz = (uint3)r6.zyw >> int3(16,16,16);
    r6.xyz = (int3)r6.zyw ^ (int3)r8.xyz;
    r1.w = mad((int)r6.y, (int)r6.z, (int)r6.x);
    r3.x = mad((int)r6.z, (int)r1.w, (int)r6.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r6.z);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r6.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r6.y = -1 + r1.w;
    r3.xz = mad((int2)r5.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r8.x = mad((int)r3.z, 0x3c6ef35f, (int)r3.x);
    r8.y = mad(0x3c6ef35f, (int)r8.x, (int)r3.z);
    r8.z = mad((int)r8.x, (int)r8.y, 0x3c6ef35f);
    r10.xyz = (uint3)r8.xyz >> int3(16,16,16);
    r8.xyz = (int3)r8.xyz ^ (int3)r10.xyz;
    r1.w = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r3.x = mad((int)r8.z, (int)r1.w, (int)r8.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r8.z);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r8.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r8.y = -1 + r1.w;
    r3.xz = r9.xy + -r7.xy;
    r3.xz = r5.yy * r3.xz + r7.xy;
    r5.zw = r8.xy + -r6.xy;
    r5.yz = r5.yy * r5.zw + r6.xy;
    r5.yz = r5.yz + -r3.xz;
    r3.xz = r5.xx * r5.yz + r3.xz;
    r3.xz = float2(-0.5,-0.5) + r3.xz;
    r4.xy = r4.zw * float2(1.79999995,1.79999995) + r4.xy;
    r3.xz = r3.xz * float2(0.150000006,0.150000006) + r4.xy;
    r3.xz = float2(9.16702843,8.56988335) + r3.xz;
    r4.xz = floor(r3.xz);
    r5.xy = mad((int2)r4.xz, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r6.x = mad((int)r5.y, 0x3c6ef35f, (int)r5.x);
    r6.y = mad(0x3c6ef35f, (int)r6.x, (int)r5.y);
    r6.z = mad((int)r6.x, (int)r6.y, 0x3c6ef35f);
    r5.xyz = (uint3)r6.xyz >> int3(16,16,16);
    r5.xyz = (int3)r5.xyz ^ (int3)r6.xyz;
    r1.w = mad((int)r5.y, (int)r5.z, (int)r5.x);
    r4.w = (uint)r1.w >> 9;
    r4.w = (int)r4.w + 0x3f800000;
    r4.w = -1.5 + r4.w;
    r5.x = dot(r7.zz, r4.ww);
    r5.y = mad((int)r5.z, (int)r1.w, (int)r5.y);
    r1.w = mad((int)r1.w, (int)r5.y, (int)r5.z);
    r5.y = (uint)r5.y >> 9;
    r6.xz = (int2)r5.yy + int2(0x3f800000,0x3f800000);
    r1.w = (uint)r1.w >> 9;
    r6.yw = (int2)r1.ww + int2(0x3f800000,0x3f800000);
    r6.xyzw = float4(-1.5,-1.5,-1.5,-1.5) + r6.xyzw;
    sincos(r5.x, r5.x, r7.x);
    r8.x = -r7.x;
    r8.y = r5.x;
    r8.z = r7.x;
    r5.x = dot(r8.yz, r6.zw);
    r5.y = dot(r8.xy, r6.zw);
    r5.xy = r5.xy * float2(0.666666687,0.666666687) + r4.xz;
    r5.xy = float2(0.5,0.5) + r5.xy;
    r5.zw = r3.xz + r3.xz;
    r7.xy = frac(r5.zw);
    r7.zw = r7.xy * float2(-2,-2) + float2(3,3);
    r7.xy = r7.xy * r7.xy;
    r7.xy = r7.zw * r7.xy;
    r5.zw = floor(r5.zw);
    r8.xyzw = float4(0,1,1,0) + r5.zwzw;
    r7.zw = float2(1,1) + r5.zw;
    r5.zw = mad((int2)r5.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r9.x = mad((int)r5.w, 0x3c6ef35f, (int)r5.z);
    r9.y = mad(0x3c6ef35f, (int)r9.x, (int)r5.w);
    r9.z = mad((int)r9.x, (int)r9.y, 0x3c6ef35f);
    r10.xyz = (uint3)r9.xyz >> int3(16,16,16);
    r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
    r1.w = mad((int)r9.y, (int)r9.z, (int)r9.x);
    r5.z = mad((int)r9.z, (int)r1.w, (int)r9.y);
    r1.w = mad((int)r1.w, (int)r5.z, (int)r9.z);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r9.x = -1 + r5.z;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r9.y = -1 + r1.w;
    r8.xyzw = mad((int4)r8.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r10.xy = mad((int2)r8.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xz);
    r8.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xy, (int2)r8.yw);
    r5.zw = mad((int2)r10.xy, (int2)r8.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r10.z = r8.x;
    r10.w = r5.z;
    r11.xyz = (uint3)r10.xzw >> int3(16,16,16);
    r10.xzw = (int3)r10.xzw ^ (int3)r11.xyz;
    r1.w = mad((int)r10.z, (int)r10.w, (int)r10.x);
    r5.z = mad((int)r10.w, (int)r1.w, (int)r10.z);
    r1.w = mad((int)r1.w, (int)r5.z, (int)r10.w);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r11.x = -1 + r5.z;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r11.y = -1 + r1.w;
    r8.z = r10.y;
    r8.w = r5.w;
    r10.xyz = (uint3)r8.zyw >> int3(16,16,16);
    r8.xyz = (int3)r8.zyw ^ (int3)r10.xyz;
    r1.w = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r5.z = mad((int)r8.z, (int)r1.w, (int)r8.y);
    r1.w = mad((int)r1.w, (int)r5.z, (int)r8.z);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r8.x = -1 + r5.z;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r8.y = -1 + r1.w;
    r5.zw = mad((int2)r7.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r10.x = mad((int)r5.w, 0x3c6ef35f, (int)r5.z);
    r10.y = mad(0x3c6ef35f, (int)r10.x, (int)r5.w);
    r10.z = mad((int)r10.x, (int)r10.y, 0x3c6ef35f);
    r12.xyz = (uint3)r10.xyz >> int3(16,16,16);
    r10.xyz = (int3)r10.xyz ^ (int3)r12.xyz;
    r1.w = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r5.z = mad((int)r10.z, (int)r1.w, (int)r10.y);
    r1.w = mad((int)r1.w, (int)r5.z, (int)r10.z);
    r5.z = (uint)r5.z >> 9;
    r5.z = (int)r5.z + 0x3f800000;
    r10.x = -1 + r5.z;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r10.y = -1 + r1.w;
    r5.zw = r11.xy + -r9.xy;
    r5.zw = r7.yy * r5.zw + r9.xy;
    r7.zw = r10.xy + -r8.xy;
    r7.yz = r7.yy * r7.zw + r8.xy;
    r7.yz = r7.yz + -r5.zw;
    r5.zw = r7.xx * r7.yz + r5.zw;
    r5.zw = float2(-0.5,-0.5) + r5.zw;
    r5.zw = r5.zw * float2(0.100000001,0.100000001) + r3.xz;
    r3.xz = r3.xz * float2(3,3) + cb0[14].xx;
    r7.xy = frac(r3.xz);
    r7.zw = r7.xy * float2(-2,-2) + float2(3,3);
    r7.xy = r7.xy * r7.xy;
    r7.xy = r7.zw * r7.xy;
    r3.xz = floor(r3.xz);
    r8.xyzw = float4(0,1,1,0) + r3.xzxz;
    r7.zw = float2(1,1) + r3.xz;
    r3.xz = mad((int2)r3.xz, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r9.x = mad((int)r3.z, 0x3c6ef35f, (int)r3.x);
    r9.y = mad(0x3c6ef35f, (int)r9.x, (int)r3.z);
    r9.z = mad((int)r9.x, (int)r9.y, 0x3c6ef35f);
    r10.xyz = (uint3)r9.xyz >> int3(16,16,16);
    r9.xyz = (int3)r9.xyz ^ (int3)r10.xyz;
    r1.w = mad((int)r9.y, (int)r9.z, (int)r9.x);
    r3.x = mad((int)r9.z, (int)r1.w, (int)r9.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r9.z);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r9.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r9.y = -1 + r1.w;
    r8.xyzw = mad((int4)r8.xyzw, int4(0x19660d,0x19660d,0x19660d,0x19660d), int4(0x3c6ef35f,0x3c6ef35f,0x3c6ef35f,0x3c6ef35f));
    r10.xy = mad((int2)r8.yw, int2(0x3c6ef35f,0x3c6ef35f), (int2)r8.xz);
    r8.xy = mad(int2(0x3c6ef35f,0x3c6ef35f), (int2)r10.xy, (int2)r8.yw);
    r3.xz = mad((int2)r10.xy, (int2)r8.xy, int2(0x3c6ef35f,0x3c6ef35f));
    r10.z = r8.x;
    r10.w = r3.x;
    r11.xyz = (uint3)r10.xzw >> int3(16,16,16);
    r10.xzw = (int3)r10.xzw ^ (int3)r11.xyz;
    r1.w = mad((int)r10.z, (int)r10.w, (int)r10.x);
    r3.x = mad((int)r10.w, (int)r1.w, (int)r10.z);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r10.w);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r11.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r11.y = -1 + r1.w;
    r8.z = r10.y;
    r8.w = r3.z;
    r10.xyz = (uint3)r8.zyw >> int3(16,16,16);
    r8.xyz = (int3)r8.zyw ^ (int3)r10.xyz;
    r1.w = mad((int)r8.y, (int)r8.z, (int)r8.x);
    r3.x = mad((int)r8.z, (int)r1.w, (int)r8.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r8.z);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r8.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r8.y = -1 + r1.w;
    r3.xz = mad((int2)r7.zw, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r10.x = mad((int)r3.z, 0x3c6ef35f, (int)r3.x);
    r10.y = mad(0x3c6ef35f, (int)r10.x, (int)r3.z);
    r10.z = mad((int)r10.x, (int)r10.y, 0x3c6ef35f);
    r12.xyz = (uint3)r10.xyz >> int3(16,16,16);
    r10.xyz = (int3)r10.xyz ^ (int3)r12.xyz;
    r1.w = mad((int)r10.y, (int)r10.z, (int)r10.x);
    r3.x = mad((int)r10.z, (int)r1.w, (int)r10.y);
    r1.w = mad((int)r1.w, (int)r3.x, (int)r10.z);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r10.x = -1 + r3.x;
    r1.w = (uint)r1.w >> 9;
    r1.w = (int)r1.w + 0x3f800000;
    r10.y = -1 + r1.w;
    r3.xz = r11.xy + -r9.xy;
    r3.xz = r7.yy * r3.xz + r9.xy;
    r7.zw = r10.xy + -r8.xy;
    r7.yz = r7.yy * r7.zw + r8.xy;
    r7.yz = r7.yz + -r3.xz;
    r3.xz = r7.xx * r7.yz + r3.xz;
    r3.xz = float2(-0.5,-0.5) + r3.xz;
    r3.xz = -r3.xz * float2(0.0700000003,0.0700000003) + r5.zw;
    r3.xz = r3.xz + -r5.xy;
    r5.x = dot(float2(0.64421767,0.764842212), r3.xz);
    r5.y = dot(float2(-0.764842212,0.64421767), r3.xz);
    r6.xyzw = r6.xyzw * float4(0.400000006,0.200000003,0.400000006,0.200000003) + float4(2.0999999,1.04999995,0.800000012,0.5);
    r5.xy = r6.xy * r5.xy;
    r1.w = dot(r5.xy, r5.xy);
    r1.w = sqrt(r1.w);
    r5.x = dot(float2(0.64421767,0.764842212), r3.xz);
    r5.y = dot(float2(-0.764842212,0.64421767), r3.xz);
    r3.xz = r5.xy * r6.zw;
    r3.x = dot(r3.xz, r3.xz);
    r3.x = sqrt(r3.x);
    r1.w = -0.000600000028 + r1.w;
    r1.w = saturate(416.666656 * r1.w);
    r3.z = r1.w * -2 + 3;
    r1.w = r1.w * r1.w;
    r1.w = -r3.z * r1.w + 1;
    r5.xyz = float3(10,2,1.25) * r1.www;
    r5.w = max(0, r1.w);
    r1.w = -721.347473 * r3.x;
    r1.w = exp2(r1.w);
    r1.w = -6.14421242e-06 + r1.w;
    r6.w = max(0, r1.w);
    r1.w = r6.w * r6.w;
    r6.xyz = float3(22.75,2.76250005,0.324999988) * r1.www;
    r5.xyzw = r6.xyzw + r5.xyzw;
    r1.w = -r4.w * 2.5 + r3.y;
    r1.w = saturate(r1.w + r1.w);
    r3.x = r1.w * -2 + 3;
    r1.w = r1.w * r1.w;
    r1.w = -r3.x * r1.w + 1;
    r3.xz = float2(0.214000002,0.214000002) + r4.xz;
    r3.xz = mad((int2)r3.xz, int2(0x19660d,0x19660d), int2(0x3c6ef35f,0x3c6ef35f));
    r6.x = mad((int)r3.z, 0x3c6ef35f, (int)r3.x);
    r6.y = mad(0x3c6ef35f, (int)r6.x, (int)r3.z);
    r6.z = mad((int)r6.x, (int)r6.y, 0x3c6ef35f);
    r4.xzw = (uint3)r6.xyz >> int3(16,16,16);
    r4.xzw = (int3)r4.xzw ^ (int3)r6.xyz;
    r3.x = mad((int)r4.z, (int)r4.w, (int)r4.x);
    r3.x = (uint)r3.x >> 9;
    r3.x = (int)r3.x + 0x3f800000;
    r3.x = -2.79999995 + r3.x;
    r3.x = -r3.x * 1.29999995 + r3.y;
    r3.x = saturate(r3.x + r3.x);
    r3.y = r3.x * -2 + 3;
    r3.x = r3.x * r3.x;
    r3.x = r3.y * r3.x;
    r1.w = r3.x * r1.w;
    r5.xyzw = r5.xyzw * r1.wwww;
    r1.w = r4.y + -r2.w;
    r1.w = saturate(0.666666687 * r1.w);
    r2.w = r1.w * -2 + 3;
    r1.w = r1.w * r1.w;
    r1.w = -r2.w * r1.w + 1;
    r4.xyzw = r5.xyzw * r1.wwww;
    r4.w = saturate(r4.w);
    r5.xyzw = cb0[24].zzzz * r4.wxyz;
    r5.x = saturate(r5.x);
    r1.w = 1 + -r5.x;
    r1.xyz = r1.xyz * r1.www + r5.yzw;
    r1.w = saturate(r4.w * cb0[24].z + r0.w);
    r1.xyzw = cb0[24].zzzz * r1.wxyz;
    r1.x = saturate(r1.x);
    r0.w = 1 + -r1.x;
    r2.xyz = r0.xyz * r0.www + r1.yzw;
  }
  // Final Output Modulation
  o0.xyz = cb0[24].xxx * r2.xyz;
  o0.w = r3.w;
  return;
}